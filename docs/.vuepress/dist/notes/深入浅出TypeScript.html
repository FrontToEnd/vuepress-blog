<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>深入浅出TypeScript | chuck</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="hi，我是chuck。一名F2Eer">
    <link rel="preload" href="/assets/css/0.styles.077cbd51.css" as="style"><link rel="preload" href="/assets/js/app.3f4decce.js" as="script"><link rel="preload" href="/assets/js/2.bdf3ae06.js" as="script"><link rel="preload" href="/assets/js/91.d36166a4.js" as="script"><link rel="prefetch" href="/assets/js/10.eada5689.js"><link rel="prefetch" href="/assets/js/11.8c577c64.js"><link rel="prefetch" href="/assets/js/12.b6715b7f.js"><link rel="prefetch" href="/assets/js/13.910bf70c.js"><link rel="prefetch" href="/assets/js/14.68fc43ad.js"><link rel="prefetch" href="/assets/js/15.7cafe28c.js"><link rel="prefetch" href="/assets/js/16.eb15a660.js"><link rel="prefetch" href="/assets/js/17.79874611.js"><link rel="prefetch" href="/assets/js/18.2ab1affb.js"><link rel="prefetch" href="/assets/js/19.a392eb25.js"><link rel="prefetch" href="/assets/js/20.712152d5.js"><link rel="prefetch" href="/assets/js/21.2c108029.js"><link rel="prefetch" href="/assets/js/22.7de1fb97.js"><link rel="prefetch" href="/assets/js/23.538fba8a.js"><link rel="prefetch" href="/assets/js/24.678c9407.js"><link rel="prefetch" href="/assets/js/25.95daf731.js"><link rel="prefetch" href="/assets/js/26.06fc523b.js"><link rel="prefetch" href="/assets/js/27.7e0e331d.js"><link rel="prefetch" href="/assets/js/28.dc5b365e.js"><link rel="prefetch" href="/assets/js/29.9876fc9b.js"><link rel="prefetch" href="/assets/js/3.e38b8b6f.js"><link rel="prefetch" href="/assets/js/30.3c5f94d7.js"><link rel="prefetch" href="/assets/js/31.ff6971b6.js"><link rel="prefetch" href="/assets/js/32.4d4bceac.js"><link rel="prefetch" href="/assets/js/33.82501ef2.js"><link rel="prefetch" href="/assets/js/34.a835b6a0.js"><link rel="prefetch" href="/assets/js/35.1c57dbf3.js"><link rel="prefetch" href="/assets/js/36.3f372679.js"><link rel="prefetch" href="/assets/js/37.1af4a03d.js"><link rel="prefetch" href="/assets/js/38.f1081cb6.js"><link rel="prefetch" href="/assets/js/39.fa03e4b7.js"><link rel="prefetch" href="/assets/js/4.3716397f.js"><link rel="prefetch" href="/assets/js/40.b860044e.js"><link rel="prefetch" href="/assets/js/41.86185343.js"><link rel="prefetch" href="/assets/js/42.0c0075b6.js"><link rel="prefetch" href="/assets/js/43.4e9ee742.js"><link rel="prefetch" href="/assets/js/44.65b2ce39.js"><link rel="prefetch" href="/assets/js/45.422be1f9.js"><link rel="prefetch" href="/assets/js/46.66c8b9f3.js"><link rel="prefetch" href="/assets/js/47.74e48322.js"><link rel="prefetch" href="/assets/js/48.866b5c4b.js"><link rel="prefetch" href="/assets/js/49.2331c42e.js"><link rel="prefetch" href="/assets/js/5.adc84131.js"><link rel="prefetch" href="/assets/js/50.01a479db.js"><link rel="prefetch" href="/assets/js/51.b46902c4.js"><link rel="prefetch" href="/assets/js/52.2e323837.js"><link rel="prefetch" href="/assets/js/53.04a399ba.js"><link rel="prefetch" href="/assets/js/54.392b71cd.js"><link rel="prefetch" href="/assets/js/55.1837e036.js"><link rel="prefetch" href="/assets/js/56.0900b3fe.js"><link rel="prefetch" href="/assets/js/57.94ca5c07.js"><link rel="prefetch" href="/assets/js/58.fdc2f5a1.js"><link rel="prefetch" href="/assets/js/59.da6b8b43.js"><link rel="prefetch" href="/assets/js/6.f4b3b355.js"><link rel="prefetch" href="/assets/js/60.2c6c08df.js"><link rel="prefetch" href="/assets/js/61.4bcf8e3a.js"><link rel="prefetch" href="/assets/js/62.6a815ac4.js"><link rel="prefetch" href="/assets/js/63.841a7f63.js"><link rel="prefetch" href="/assets/js/64.42844f28.js"><link rel="prefetch" href="/assets/js/65.6bb320a1.js"><link rel="prefetch" href="/assets/js/66.7f0781a0.js"><link rel="prefetch" href="/assets/js/67.9999f087.js"><link rel="prefetch" href="/assets/js/68.be67ff7c.js"><link rel="prefetch" href="/assets/js/69.270a4048.js"><link rel="prefetch" href="/assets/js/7.00249ed3.js"><link rel="prefetch" href="/assets/js/70.7e58fdde.js"><link rel="prefetch" href="/assets/js/71.737dc345.js"><link rel="prefetch" href="/assets/js/72.2d565df3.js"><link rel="prefetch" href="/assets/js/73.4cf51495.js"><link rel="prefetch" href="/assets/js/74.1aa0e1bf.js"><link rel="prefetch" href="/assets/js/75.e0e34199.js"><link rel="prefetch" href="/assets/js/76.82acf861.js"><link rel="prefetch" href="/assets/js/77.e589714d.js"><link rel="prefetch" href="/assets/js/78.8e9abadd.js"><link rel="prefetch" href="/assets/js/79.9e1fc178.js"><link rel="prefetch" href="/assets/js/8.703362e2.js"><link rel="prefetch" href="/assets/js/80.2a43e147.js"><link rel="prefetch" href="/assets/js/81.ca7bc668.js"><link rel="prefetch" href="/assets/js/82.c9e21c1b.js"><link rel="prefetch" href="/assets/js/83.a975c135.js"><link rel="prefetch" href="/assets/js/84.365e7338.js"><link rel="prefetch" href="/assets/js/85.64af8645.js"><link rel="prefetch" href="/assets/js/86.1b0bd26b.js"><link rel="prefetch" href="/assets/js/87.dde120f2.js"><link rel="prefetch" href="/assets/js/88.32dc5669.js"><link rel="prefetch" href="/assets/js/89.446a8227.js"><link rel="prefetch" href="/assets/js/9.7089b1f5.js"><link rel="prefetch" href="/assets/js/90.86e48091.js"><link rel="prefetch" href="/assets/js/92.2aa12fec.js">
    <link rel="stylesheet" href="/assets/css/0.styles.077cbd51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/img/logo.png" alt="chuck" class="logo"> <span class="site-name">chuck</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          🍧首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/guide/">
          🏆规范
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/article/">
          📒文章
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/notes/" class="router-link-active">
          📚笔记
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/algorithm/">
          🌲算法
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          🌈联系
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/FrontToEnd/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/notes/阅读Mijin有感.html" title="阅读Mijin有感" class="sidebar-link">阅读Mijin有感</a></li><li><a href="/notes/如何学习前端.html" title="如何学习前端" class="sidebar-link">如何学习前端</a></li><li><a href="/notes/工具库源码解析.html" title="工具库源码解析" class="sidebar-link">工具库源码解析</a></li><li><a href="/notes/深入浅出TypeScript.html" title="深入浅出TypeScript" class="active sidebar-link">深入浅出TypeScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#原始类型" title="原始类型" class="sidebar-link">原始类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#其他类型" title="其他类型" class="sidebar-link">其他类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#枚举类型" title="枚举类型" class="sidebar-link">枚举类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#interface" title="interface" class="sidebar-link">interface</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#类" title="类" class="sidebar-link">类</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#函数" title="函数" class="sidebar-link">函数</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#泛型" title="泛型" class="sidebar-link">泛型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#类型断言和类型守卫" title="类型断言和类型守卫" class="sidebar-link">类型断言和类型守卫</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#类型兼容性" title="类型兼容性" class="sidebar-link">类型兼容性</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#高级类型" title="高级类型" class="sidebar-link">高级类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#可辨识联合类型" title="可辨识联合类型" class="sidebar-link">可辨识联合类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#装饰器" title="装饰器" class="sidebar-link">装饰器</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#高级类型-2" title="高级类型" class="sidebar-link">高级类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#常用工具类型" title="常用工具类型" class="sidebar-link">常用工具类型</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#编译器" title="编译器" class="sidebar-link">编译器</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#编写声明文件" title="编写声明文件" class="sidebar-link">编写声明文件</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#手写events声明文件" title="手写events声明文件" class="sidebar-link">手写events声明文件</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#tsconfig-json" title="tsconfig.json" class="sidebar-link">tsconfig.json</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#eslint" title="ESLint" class="sidebar-link">ESLint</a></li><li class="sidebar-sub-header"><a href="/notes/深入浅出TypeScript.html#总结" title="总结" class="sidebar-link">总结</a></li></ul></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="深入浅出typescript"><a href="#深入浅出typescript" class="header-anchor">#</a> 深入浅出TypeScript</h1> <p>本文是阅读小册 <strong>《深入浅出TypeScript》</strong> 的阅读笔记，对<code>TypeScript</code>感兴趣的同学请继续阅读吧。</p> <h2 id="原始类型"><a href="#原始类型" class="header-anchor">#</a> 原始类型</h2> <p><strong>TypeScript</strong>的原始类型包括: <strong>boolean、number、string、void、undefined、null、symbol、bigint。</strong></p> <p>需要注意的是，<code>number</code>是类型，而<code>Number</code>是构造函数。</p> <ul><li>当函数没有返回值时，返回类型就是<code>void</code>。只有<code>null</code>和<code>undefined</code>可以赋给<code>void</code> 。</li> <li>默认情况下 <code>null</code> 和 <code>undefined</code>是所有类型的子类型。开启<code>--strictNullChecks</code> 后，<code>null</code> 和 <code>undefined</code>只能赋值给 <code>any</code>和它们各自以及<code>void</code>。</li> <li><code>number</code>和<code>bigint</code>类型的值不能互相赋值。</li></ul> <h2 id="其他类型"><a href="#其他类型" class="header-anchor">#</a> 其他类型</h2> <ol><li><p><code>any</code>。绕过编译阶段的检查，避免使用。</p></li> <li><p><code>unknown</code> 。是 <code>any</code> 类型对应的安全类型。当 <code>unknown</code> 类型被确定是某个类型之前,它不能被进行任何操作，此时需要类型保护来完成类型的判断。</p></li> <li><p><code>never</code> 。<code>never</code> 类型表示的是那些永不存在的值的类型，<code>never</code>类型是任何类型的子类型，也可以赋值给任何类型；然而，没有类型是 <code>never</code>的子类型或可以赋值给 <code>never</code>类型（除了<code>never</code>本身之外）。示例如下：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 抛出异常的函数永远不会有返回值</span>
<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 空数组，而且永远是空的</span>
<span class="token keyword">const</span> empty<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>数组。用法示例：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> list<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = [1, 2, 3]
const list: number[] = [1, 2, 3]
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>元组。表示一个已知元素数量和类型的数组，各元素的类型不必相同。元组中包含的元素，必须与声明的类型一致，而且不能多、不能少，甚至顺序不能不符。堪称严格版的数组。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> x<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>

<span class="token comment">// 上述元组可以看做为：</span>
<span class="token keyword">interface</span> <span class="token class-name">Tuple</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token number">0</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  length<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>object。表示非原始类型。比如枚举、数组、元组都是object类型。</p></li></ol> <h2 id="枚举类型"><a href="#枚举类型" class="header-anchor">#</a> 枚举类型</h2> <p>声明枚举类型时，如果没有显式的赋值，那么枚举值从0递增。如果显式赋值，那么后面的值从当前值递增。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>
    Up<span class="token punctuation">,</span>
    Down<span class="token punctuation">,</span>
    Left<span class="token punctuation">,</span>
    Right
<span class="token punctuation">}</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Direction<span class="token punctuation">.</span>Up <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>枚举类型的值可以是字符串。枚举可以反向映射，也就是可以<code>key&lt;=&gt;value</code>。</p> <h3 id="常量枚举"><a href="#常量枚举" class="header-anchor">#</a> 常量枚举</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>
    Up <span class="token operator">=</span> <span class="token string">'Up'</span><span class="token punctuation">,</span>
    Down <span class="token operator">=</span> <span class="token string">'Down'</span><span class="token punctuation">,</span>
    Left <span class="token operator">=</span> <span class="token string">'Left'</span><span class="token punctuation">,</span>
    Right <span class="token operator">=</span> <span class="token string">'Right'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> Direction<span class="token punctuation">.</span>Up<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>好处是编译成<code>JavaScript</code>后，会直接去除<code>Direction</code>的声明，来提升性能。</p> <h3 id="联合枚举类型"><a href="#联合枚举类型" class="header-anchor">#</a> 联合枚举类型</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">enum</span> Direction <span class="token punctuation">{</span>
    Up<span class="token punctuation">,</span>
    Down<span class="token punctuation">,</span>
    Left<span class="token punctuation">,</span>
    Right
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> <span class="token keyword">let</span> a<span class="token operator">:</span> Direction
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>将变量<code>a</code>声明为<code>Direction</code>类型，意味着声明了一个联合类型。也就是：</p> <p><code>Direction.Up | Direction.Down | Direction.Left | Direction.Right</code></p> <h3 id="枚举合并"><a href="#枚举合并" class="header-anchor">#</a> 枚举合并</h3> <p>可以分开声明枚举，会自动合并。</p> <h2 id="interface"><a href="#interface" class="header-anchor">#</a> interface</h2> <p>接口可以用来描述参数的结构。接口不会去检查属性的顺序，只要相应的属性存在并且类型兼容即可。</p> <h3 id="可选属性和只读属性"><a href="#可选属性和只读属性" class="header-anchor">#</a> 可选属性和只读属性</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span>
    age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token comment">// 可选属性</span>
    <span class="token keyword">readonly</span> isMale<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token comment">// 只读属性</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="函数类型"><a href="#函数类型" class="header-anchor">#</a> 函数类型</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Say</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>words<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span>
    age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
    <span class="token keyword">readonly</span> isMale<span class="token operator">:</span> <span class="token builtin">boolean</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">words<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span>
    say<span class="token operator">:</span> Say <span class="token comment">// 或者使用接口描述函数类型</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="字符串索引签名"><a href="#字符串索引签名" class="header-anchor">#</a> 字符串索引签名</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Height</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token comment">// 属性值可以是任意字符串</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span>
   width<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
   height<span class="token operator">:</span> Height<span class="token punctuation">,</span>
   <span class="token punctuation">[</span>propName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="继承接口"><a href="#继承接口" class="header-anchor">#</a> 继承接口</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">VIPUser</span> <span class="token keyword">extends</span> <span class="token class-name">User</span><span class="token punctuation">,</span> SupperUser <span class="token punctuation">{</span> <span class="token comment">// 可以继承多个接口</span>
    <span class="token function-variable function">broadcast</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="类"><a href="#类" class="header-anchor">#</a> 类</h2> <p><strong>TypeScript</strong>的类加强了<strong>JavaScript</strong>中尚未引入的一些类的特性，下面进行总结。</p> <h3 id="抽象类"><a href="#抽象类" class="header-anchor">#</a> 抽象类</h3> <p>抽象类做为其它派生类的基类使用，它们一般不会直接被实例化。而且直接实例化会报错。此时需要通过子类继承抽象类。</p> <p><code>abstract</code> 关键字是用于定义抽象类和在抽象类内部定义抽象方法。</p> <p>创建一个抽象类：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token function">makeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'move'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="访问限定符"><a href="#访问限定符" class="header-anchor">#</a> 访问限定符</h3> <p><code>TypeScript</code> 中有三类访问限定符，分别是: <code>public</code>、<code>private</code>、<code>protected</code>。</p> <p>在 <code>TypeScript</code> 的类中，成员都默认为 <code>public</code>, 被此限定符修饰的成员是<strong>可以被外部访问</strong>。</p> <p>当成员被设置为 <code>private</code>之后, 被此限定符修饰的成员是<strong>只可以被类的内部访问</strong>。</p> <p>当成员被设置为 <code>protected</code>之后, 被此限定符修饰的成员是<strong>只可以被类的内部以及类的子类访问</strong>。</p> <h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <p><code>TypeScript</code> 为 <code>JavaScript</code> 函数添加了额外的功能，下面进行总结。</p> <h3 id="定义函数类型"><a href="#定义函数类型" class="header-anchor">#</a> 定义函数类型</h3> <p>一般来说，<code>TypeScript</code> 编译器是能『感知』到函数的类型，这也就是<strong>类型推断</strong>。我们也可以显示的定义函数类型，示例如下：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 加粗部分就是函数类型的定义</span>
<span class="token keyword">const</span> add<span class="token operator">:</span> <span class="token operator">**</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">number</span><span class="token operator">**</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="函数参数"><a href="#函数参数" class="header-anchor">#</a> 函数参数</h3> <p>函数参数包括<strong>可选参数</strong>、<strong>默认参数</strong>、<strong>剩余参数</strong>和<strong>正常传入的参数</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">?</span> b <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 可选参数，类型为**联合类型number | undefined**</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b <span class="token comment">// 默认参数</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> rest<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// 剩余参数rest</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="返回值"><a href="#返回值" class="header-anchor">#</a> 返回值</h3> <p>函数的返回值类型除了返回原始类型之外，一般还会经常返回 <code>any,nerver,void</code> 。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> <span class="token function">any</span> <span class="token punctuation">(</span><span class="token parameter">info<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'void'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="重载"><a href="#重载" class="header-anchor">#</a> 重载</h3> <p><strong>函数重载</strong>：<strong>函数项名称相同</strong>但输入输出类型或个数不同的<strong>子程序</strong>，它可以简单地称为一个单独功能可以执行多项任务的能力。</p> <p><strong>TypeScript 的函数重载</strong>： 为同一个函数提供<strong>多个函数类型定义</strong>来进行函数重载，目的是重载的 函数在调用的时候会进行<strong>正确的类型检查</strong>。</p> <h2 id="泛型"><a href="#泛型" class="header-anchor">#</a> 泛型</h2> <p><strong>泛型</strong>给予开发者创造灵活、可重用代码的能力。</p> <p>设计泛型的关键目的是<strong>在成员之间提供有意义的约束</strong>，这些成员可以是：类的实例成员、类的方法、函数参数和函数返回值。</p> <p>举例如下：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> getItem<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(params: T): T </span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> params<span class="token punctuation">;</span> <span class="token comment">// 传入参数类型和返回参数类型一致</span>
<span class="token punctuation">}</span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="泛型变量"><a href="#泛型变量" class="header-anchor">#</a> 泛型变量</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> getArrayLength<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(arg: Array</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">) </span><span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arg <span class="token keyword">as</span> <span class="token builtin">Array</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>any</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">).length)
  return arg;
}
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="泛型接口"><a href="#泛型接口" class="header-anchor">#</a> 泛型接口</h3> <p>泛型可以用于声明接口。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">returnItemFn</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>
  <span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">}</span><span class="token plain-text">

const returnItem: returnItemFn</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = params =&gt; params // 使用泛型接口声明函数
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="泛型类"><a href="#泛型类" class="header-anchor">#</a> 泛型类</h3> <p>泛型除了可以在函数中使用，还可以在类中使用，它既可以作用于类本身，也可以作用于类的成员函数。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">class</span> <span class="token class-name">Stack</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>
  <span class="token keyword">private</span> arr<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">public</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="泛型约束"><a href="#泛型约束" class="header-anchor">#</a> 泛型约束</h3> <p>我们可以用 <code>&lt;T extends xx&gt;</code> 的方式约束泛型。上述示例可以约束为接收<code>number</code>和<code>string</code>类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Params <span class="token operator">=</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Stack</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span> <span class="token attr-name">extends</span> <span class="token attr-name">Params</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>
  <span class="token keyword">private</span> arr<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">public</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>使用<strong>索引类型</strong>进行实现 <code>&lt;U extends keyof T&gt;</code>，我们用<strong>索引类型</strong> <code>keyof T</code> 把传入的对象的属性类型取出生成一个<strong>联合类型</strong>，这里的泛型 U 被约束在这个<strong>联合类型</strong>中。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> getValue<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span> <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用<strong>交叉类型</strong>进行多类型约束。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">FirstInterface</span> <span class="token punctuation">{</span>
  <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SecondInterface</span> <span class="token punctuation">{</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Union</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">FirstInterface</span> <span class="token operator">&amp;</span> SecondInterface<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> genericProperty<span class="token operator">:</span> <span class="token constant">T</span>

  <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>genericProperty<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>genericProperty<span class="token punctuation">.</span><span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="泛型与new"><a href="#泛型与new" class="header-anchor">#</a> 泛型与new</h3> <p>默认情况下，泛型不能构造，需要<strong>声明泛型为构造函数</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> factory<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">(type: </span><span class="token punctuation">{</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span><span class="token plain-text">): T </span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>参数 <code>type</code> 的类型 <code>{new(): T}</code> 就表示此泛型 T 是可被构造的。</p> <h2 id="类型断言和类型守卫"><a href="#类型断言和类型守卫" class="header-anchor">#</a> 类型断言和类型守卫</h2> <h3 id="类型断言"><a href="#类型断言" class="header-anchor">#</a> 类型断言</h3> <p>使用类型断言告诉编译器我知道我在做什么，但是不要滥用。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Person<span class="token punctuation">;</span> <span class="token comment">// 类型断言为Person接口</span>

person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'xx'</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>双重断言可以规避编译器的一些报错，但是不建议使用。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token string">'xx'</span> <span class="token keyword">as</span> <span class="token builtin">any</span> <span class="token keyword">as</span> Person<span class="token punctuation">;</span> <span class="token comment">// 双重断言为Person接口</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="类型守卫"><a href="#类型守卫" class="header-anchor">#</a> 类型守卫</h3> <p><strong>类型守卫</strong>就是缩小类型的范围。以下方式可以进行类型守卫：</p> <ol><li><p><code>instanceof</code></p></li> <li><p>in</p></li> <li><p>字面量类型守卫</p></li> <li><p><code>typeof</code></p></li></ol> <p>下面示例分别代表四种类型守卫：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>arg <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token keyword">in</span> Person<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'chuck'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> name <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="类型兼容性"><a href="#类型兼容性" class="header-anchor">#</a> 类型兼容性</h2> <p><strong>类型兼容性</strong>用于确定一个类型是否能赋值给其他类型。</p> <h3 id="结构类型"><a href="#结构类型" class="header-anchor">#</a> 结构类型</h3> <p><code>TypeScript</code> 里的类型兼容性是基于「结构类型」的，结构类型是一种只使用其成员来描述类型的方式。其基本规则是，如果 x 要兼容 y，那么 y 至少具有与 x 相同的属性。</p> <h3 id="函数参数兼容性"><a href="#函数参数兼容性" class="header-anchor">#</a> 函数参数兼容性</h3> <p>x 的每个参数必须能在 y 里找到对应类型的参数。注意：只看类型，不看参数名称。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">let</span> <span class="token function-variable function">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">y</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> s<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

y <span class="token operator">=</span> x<span class="token punctuation">;</span> <span class="token comment">// OK</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Error 不能将类型“(b: number, s: string) =&gt; number”分配给类型“(a: number) =&gt; number”。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>当参数为可选时，如果是严格检测模式，那么<strong>可选类型无法兼容必选类型</strong>，因为可选类型可能是<code>undefined</code> 。</p> <h3 id="枚举类型兼容性"><a href="#枚举类型兼容性" class="header-anchor">#</a> 枚举类型兼容性</h3> <p>枚举与数字类型相互兼容。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">enum</span> Status <span class="token punctuation">{</span>
  Ready<span class="token punctuation">,</span>
  Waiting
<span class="token punctuation">}</span>

<span class="token keyword">let</span> status <span class="token operator">=</span> Status<span class="token punctuation">.</span>Ready<span class="token punctuation">;</span>
<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

status <span class="token operator">=</span> num<span class="token punctuation">;</span>
num <span class="token operator">=</span> status<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="类的类型兼容性"><a href="#类的类型兼容性" class="header-anchor">#</a> 类的类型兼容性</h3> <p>仅仅只有实例成员和方法会相比较，构造函数和静态成员不会被检查。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  feet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> numFeet<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Size</span> <span class="token punctuation">{</span>
  feet<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">meters<span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a<span class="token operator">:</span> Animal<span class="token punctuation">;</span>
<span class="token keyword">let</span> s<span class="token operator">:</span> Size<span class="token punctuation">;</span>

a <span class="token operator">=</span> s<span class="token punctuation">;</span> <span class="token comment">// OK</span>
s <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment">// OK</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>私有的和受保护的成员必须来自于相同的类。</p> <h3 id="泛型类型兼容性"><a href="#泛型类型兼容性" class="header-anchor">#</a> 泛型类型兼容性</h3> <p>泛型本身就是不确定的类型,它的表现根据<strong>是否被成员使用而不同</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span> <span class="token comment">// 没有被成员使用，ok</span>

<span class="token punctuation">}</span><span class="token plain-text">

let x : Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
let y : Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

x = y // ok
y = x // ok

interface Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span> <span class="token comment">// 被成员name使用，不ok</span>
    name<span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">}</span><span class="token plain-text">

let x : Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>string</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
let y : Person</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

x = y // 不能将类型“Person&lt;number&gt;”分配给类型“Person&lt;string&gt;”。
y = x // 不能将类型“Person&lt;string&gt;”分配给类型“Person&lt;number&gt;”。
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="高级类型"><a href="#高级类型" class="header-anchor">#</a> 高级类型</h2> <h3 id="交叉类型"><a href="#交叉类型" class="header-anchor">#</a> 交叉类型</h3> <p><strong>交叉类型</strong>是将多个类型合并为一个类型。它包含了所需的所有类型的特性。</p> <p>交叉类型可以方便我们进行混入对象的属性：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">IAnyObject</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>prop<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> mixin<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">IAnyObject</span><span class="token punctuation">,</span> <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name">IAnyObject</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>first<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> second<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> id <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">result)[id] = first[id];
    }
    for (let id in second) </span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">U</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">result)[id] = second[id];
      }
    }
  
    return result;
  }
  
  const x = mixin(</span><span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token string">'hello'</span> <span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token number">42</span> <span class="token punctuation">}</span><span class="token plain-text">);
  
  // 现在 x 拥有了 a 属性与 b 属性
  const a = x.a;
  const b = x.b;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="联合类型"><a href="#联合类型" class="header-anchor">#</a> 联合类型</h3> <p><strong>联合类型</strong>表示一个值可以是几种类型之一。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> wrapRaf <span class="token operator">=</span> ref<span class="token operator">&lt;</span>HTMLDivElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// vue3中声明一个dom元素的引用</span>

<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 可选参数a的类型就是联合类型 number | undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="类型别名"><a href="#类型别名" class="header-anchor">#</a> 类型别名</h3> <p><strong>类型别名</strong>会给一个类型起个新名字，类型别名有时和接口很像，但是可以作用于原始值、联合类型、元组以及其它任何你需要手写的类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> some <span class="token operator">=</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> Container<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span><span class="token plain-text">;
type Tree</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token comment">// 属性中引用自己</span>
    value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
    left<span class="token operator">:</span> Tree<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;
    right: Tree</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;
}
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如何区分类型别名和接口？</p> <p><code>interface</code>只能用于<strong>定义对象类型</strong>，而 <code>type</code>的声明方式除了对象之外还可以<strong>定义交叉、联合、原始类型</strong>等，类型声明的方式适用范围显然更加广泛。</p> <p>但是<code>interface</code>也有其特定的用处：</p> <ul><li><code>interface</code>方式可以实现接口的 <code>extends</code>和 <code>implements</code></li> <li><code>interface</code>可以实现接口合并声明</li></ul> <h2 id="可辨识联合类型"><a href="#可辨识联合类型" class="header-anchor">#</a> 可辨识联合类型</h2> <p>首先介绍下<strong>字面量类型</strong>和<strong>类型字面量</strong>的概念。两者没有什么关系，但是名字很像容易混淆。</p> <h3 id="字面量类型"><a href="#字面量类型" class="header-anchor">#</a> 字面量类型</h3> <p><strong>字面量</strong>（Literal Type）主要分为 <strong>真值字面量类型</strong>（boolean literal types）,<strong>数字字面量类型</strong>（numeric literal types）,<strong>枚举字面量类型</strong>（enum literal types）,<strong>大整数字面量类型</strong>（bigInt literal types）和<strong>字符串字面量类型</strong>（string literal types）。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">const</span> a<span class="token operator">:</span> <span class="token number">886</span> <span class="token operator">=</span> <span class="token number">886</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
<span class="token keyword">const</span> site<span class="token operator">:</span> <span class="token string">'chuck'</span> <span class="token operator">=</span> <span class="token string">'chuck'</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>字面量类型要和实际值的字面量一一对应，如果不一致就会报错。字面量类型有何作用？</p> <p>当其与联合类型结合的时候，可以达到模拟枚举的效果：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Direction <span class="token operator">=</span> <span class="token string">'North'</span> <span class="token operator">|</span> <span class="token string">'East'</span> <span class="token operator">|</span> <span class="token string">'South'</span> <span class="token operator">|</span> <span class="token string">'West'</span><span class="token punctuation">;</span> <span class="token comment">// 该类型别名只有指定的四个方向值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="类型字面量"><a href="#类型字面量" class="header-anchor">#</a> 类型字面量</h3> <p><strong>类型字面量</strong>(Type Literal)跟 JavaScript 中的对象字面量的语法很相似。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  baz<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token builtin">number</span><span class="token punctuation">,</span>
    <span class="token string">'chuck'</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'github'</span><span class="token punctuation">;</span>
  <span class="token number">0x1</span><span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">;</span>
  <span class="token string">&quot;bar&quot;</span><span class="token operator">:</span> <span class="token number">12n</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>一定程度上类型字面量可以代替接口。</p> <h3 id="可辨识联合类型-2"><a href="#可辨识联合类型-2" class="header-anchor">#</a> 可辨识联合类型</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> UserAction <span class="token operator">=</span> <span class="token operator">|</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">number</span>
    action<span class="token operator">:</span> <span class="token string">'delete'</span>
    info<span class="token operator">:</span> Info
<span class="token punctuation">}</span> <span class="token operator">|</span>
<span class="token punctuation">{</span>
    action<span class="token operator">:</span> <span class="token string">'create'</span>
    info<span class="token operator">:</span> Info
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">UserReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">userAction<span class="token operator">:</span> UserAction</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>userAction<span class="token punctuation">.</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 可辨识的标签</span>
        <span class="token keyword">case</span> <span class="token string">'delete'</span><span class="token operator">:</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userAction<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>实现上述模式需要满足：</p> <ul><li>具有普通的单例类型属性—可辨识的特征,上文中就是 <code>delete</code> 与 <code>create</code> 两个有唯一性的字符串字面量</li> <li>一个类型别名包含<strong>联合类型</strong></li> <li>类型守卫的特性,比如我们必须用 <code>if</code> <code>switch</code> 来判断 <code>userAction.action</code> 是属于哪个类型作用域即 <code>delete</code> 与 <code>create</code></li></ul> <h2 id="装饰器"><a href="#装饰器" class="header-anchor">#</a> 装饰器</h2> <p><strong>装饰器</strong>(decorator)最早在 <code>Python</code> 中被引入,它的主要作用是给一个已有的方法或类扩展一些新的行为，而不是去直接修改它本身。</p> <p>该语法推进较为缓慢，需要进行配置方可使用。</p> <p>在 <code>JavaScript</code> 中我们需要 <code>Babel</code> 插件 <code>babel-plugin-transform-decorators-legacy</code> 来支持 <code>decorator</code>,而在 Typescript 中我们需要在 <code>tsconfig.json</code> 里面开启支持选项 <code>experimentalDecorators</code> 。</p> <ol><li>目前装饰器本质上是一个函数,<code>@expression</code> 的形式其实是一个语法糖, expression 求值后必须也是一个函数，它会在运行时被调用，被装饰的声明信息做为参数传入。</li> <li><code>JavaScript</code>中的 <code>Class</code>其实也是一个语法糖。</li></ol> <h2 id="高级类型-2"><a href="#高级类型-2" class="header-anchor">#</a> 高级类型</h2> <h3 id="索引类型"><a href="#索引类型" class="header-anchor">#</a> 索引类型</h3> <p>先来了解两个类型操作符：<strong>索引类型查询操作符</strong>和<strong>索引访问操作符</strong>。</p> <p><code>keyof</code>，即索引类型查询操作符，我们可以用 <code>keyof</code>作用于泛型 <code>T</code> 上来获取泛型 <code>T</code> 上的所有 <code>public</code>属性名构成联合类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">class</span> <span class="token class-name">Images</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> src<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'https://www.google.com.hk/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png'</span>
    <span class="token keyword">public</span> alt<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'谷歌'</span>
    <span class="token keyword">public</span> width<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">500</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> propsNames <span class="token operator">=</span> <span class="token keyword">keyof</span> Images <span class="token comment">// type propsNames = 'src' | 'alt' | 'width'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>与 <code>JavaScript</code>种访问属性值的操作类似，访问类型的操作符也是通过 <code>[]</code> 来访问的，即 <code>T[K]</code>。</p> <p>实现TS版的<code>pick</code>函数：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">function</span> pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>o<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> names<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> names<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">n</span> <span class="token operator">=&gt;</span> o<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="映射类型"><a href="#映射类型" class="header-anchor">#</a> 映射类型</h3> <p><strong>映射类型</strong>的语法是<code>[K in Keys]</code>:</p> <ul><li><code>K</code>：类型变量，依次绑定到每个属性上，对应每个属性名的类型</li> <li><code>Keys</code>：字符串字面量构成的联合类型，表示一组属性名（的类型）</li></ul> <p>实现TS的可选类型函数：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> partial<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token plain-text">
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="条件类型"><a href="#条件类型" class="header-anchor">#</a> 条件类型</h3> <p><strong>条件类型</strong>表示非统一的类型,以一个条件表达式进行类型关系检测，从而在两种类型中选择其一:</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> <span class="token constant">X</span> <span class="token operator">:</span> <span class="token constant">Y</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面的代码可以理解为: 若 <code>T</code> 能够赋值给 <code>U</code>，那么类型是 <code>X</code>，否则为 <code>Y</code>,有点类似于<code>JavaScript</code>中的三元条件运算符。</p> <h3 id="条件类型与联合类型"><a href="#条件类型与联合类型" class="header-anchor">#</a> 条件类型与联合类型</h3> <p>条件类型有一个特性,就是「分布式有条件类型」，但是分布式有条件类型是有前提的，条件类型里待检查的类型必须是<code>naked type parameter：裸类型参数</code> 。</p> <p><strong>分布式有条件类型</strong>在实例化时会自动分发成联合类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// 裸类型参数,没有被任何其他类型包裹即T</span>
<span class="token keyword">type</span> NakedUsage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = T extends boolean ? &quot;YES&quot; : &quot;NO&quot;
type Distributed = NakedUsage&lt;number | boolean&gt; //  等价于NakedUsage&lt;number&gt; | NakedUsage&lt;boolean&gt; =  &quot;NO&quot; | &quot;YES&quot;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当我们给类型<code>NakedUsage</code>加入联合类型<code>number | boolean</code>时,它的结果返回<code>&quot;NO&quot; | &quot;YES&quot;</code>,相当于联合类型中的<code>number</code>和<code>boolean</code>分别赋予了<code>NakedUsage&lt;T&gt;</code>然后再返回出一个联合类型。类似于<code>Array.map()</code> 。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token comment">// 找出T类型中U不包含的部分</span>

<span class="token keyword">type</span> <span class="token constant">R</span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;b&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;c&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;f&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;b&quot; | &quot;d&quot;</span>

<span class="token keyword">type</span> Filter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span> <span class="token comment">// filter方法</span>

<span class="token keyword">type</span> NonNullable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = Diff&lt;T, null | undefined&gt;; // 剔除null和undefined
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="条件类型与映射类型"><a href="#条件类型与映射类型" class="header-anchor">#</a> 条件类型与映射类型</h3> <p>编写工具类型，作用为：将interface中<strong>函数类型</strong>的<strong>名称</strong>取出来。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">Part</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    subparts<span class="token operator">:</span> Part<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">updatePart</span><span class="token punctuation">(</span>newName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token constant">R</span> <span class="token operator">=</span> FunctionPropertyNames<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Part</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;

type FunctionPropertyNames</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token constant">K</span> <span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">}</span><span class="token plain-text">[keyof T]
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>1、首先看大括号里面的：<code>[K in keyof T]</code>遍历整个泛型，得到所有的<code>key</code>；<code>T[K]</code> 就是所有的<code>value</code>；</p> <p>2、用条件类型验证<code>value</code>是不是<code>Function</code> ，如果是，将<code>key</code>当作新接口的值进行存储；如果不是，则将<code>never</code>当作新接口的值存储。此时大括号里的就会是：</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	id<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
  subparts<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
  updatePart<span class="token operator">:</span> <span class="token string">&quot;updatePart&quot;</span><span class="token punctuation">;</span> <span class="token comment">// 该类型是Function，所以接口的值是泛型的key</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>3、使用<code>[keyof T]</code> 依次取出上面生成的接口里的<code>value</code> 。可以理解为对象的大括号取值。如果<code>value</code>为<code>never</code>，则不返回任何类型；如果不是<code>never</code>，则直接返回。</p> <h3 id="infer关键字"><a href="#infer关键字" class="header-anchor">#</a> infer关键字</h3> <p><code>infer</code> 是工具类型和底层库中非常常用的关键字，表示<strong>在 extends 条件语句中待推断的类型变量</strong> 。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> ParamType<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = T extends (param: infer P) =&gt; any ? P : T;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果 <code>T</code> 能赋值给 <code>(param: infer P) =&gt; any</code>，则结果是<code>(param: infer P) =&gt; any</code>类型中的参数 <code>P</code>，否则返回为 <code>T</code>,<code>infer P</code>表示待推断的函数参数。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> ReturnType<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = T extends (...args: any[]) =&gt; infer P ? P : any;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果<code>T</code>能赋值给函数类型，则返回函数的返回类型。通过<code>infer P</code>来提取函数的返回类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> ConstuctorParameters<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">new</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">new</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args<span class="token operator">:</span> infer <span class="token constant">P</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>1、<code>new (...args: any[]) =&gt; any</code> 指构造函数。</p> <p>2、<code>infer P</code> 表示待推断的构造函数参数，如果<code>T</code>是构造函数，就返回构造函数的类型参数<code>P</code>，否则返回<code>never</code>。</p> <h3 id="infer的应用"><a href="#infer的应用" class="header-anchor">#</a> infer的应用</h3> <p>将元组转换为联合类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> ELementOf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = T extends Array</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>infer</span> <span class="token attr-name">E</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> ? E : never;

type TTuple = [string, number];

type ToUnion = ElementOf</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TTuple</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">; // string | number;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>将联合类型转换为交叉类型。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> UnionToIntersection<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">U</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = (U extends any ? (k: U) =&gt; void : never) extends ((k: infer I) =&gt; void) ? I : never;

type Result = UnionToIntersection&lt;string | number&gt;;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="常用工具类型"><a href="#常用工具类型" class="header-anchor">#</a> 常用工具类型</h2> <p>将属性全部变为<strong>可选</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Partial<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token plain-text">;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上述工具只能转换一层，无法转换嵌套属性。因此需要<strong>类型递归</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> DeepPartial<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span>
	<span class="token punctuation">[</span><span class="token constant">U</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">U</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span> <span class="token operator">?</span> DeepPartial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">U</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">U</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token plain-text">
// 当value为对象类型，则递归调用
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>+和-</code>两个关键字用于映射类型中给属性添加修饰符，比如<code>-?</code>就代表将可选属性变为必选，<code>-readonly</code>代表将只读属性变为非只读。</p> <p>下面的工具类型用来将属性全部变为<strong>必选</strong>。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Required<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token plain-text">;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="exclude"><a href="#exclude" class="header-anchor">#</a> Exclude</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token constant">TT</span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">3</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>Exclude</code> 的作用是从<code>T</code>中排除出<strong>可分配</strong>给<code>U</code>的元素。也就是说，如果<code>T</code>不能赋值给<code>U</code>，则返回该值。如果有多个值不能赋值，则<code>TT</code>是联合类型。</p> <h3 id="omit"><a href="#omit" class="header-anchor">#</a> Omit</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Exclude<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> Foo <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token operator">&gt;</span> <span class="token comment">// { age: number }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>Omit</code>的作用是忽略<code>T</code>中的某些属性。</p> <h3 id="compute"><a href="#compute" class="header-anchor">#</a> Compute</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Compute<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">A</span></span> <span class="token attr-name">extends</span> <span class="token attr-name">any</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = A extends Function ? A : </span><span class="token punctuation">{</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token plain-text">;

type R1 = Compute&lt;</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token string">'x'</span> <span class="token punctuation">}</span><span class="token plain-text"> &amp; </span><span class="token punctuation">{</span> y<span class="token operator">:</span> <span class="token string">'y'</span> <span class="token punctuation">}</span><span class="token plain-text">&gt; // {x: &quot;x&quot;, y: &quot;y&quot;}

type R2 = Compute&lt;</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token string">'x'</span><span class="token punctuation">;</span> y<span class="token operator">:</span> <span class="token string">'y1'</span> <span class="token punctuation">}</span><span class="token plain-text"> &amp; </span><span class="token punctuation">{</span> y<span class="token operator">:</span> <span class="token string">'y'</span> <span class="token punctuation">}</span><span class="token plain-text">&gt; // {x: &quot;x&quot;, y: never}
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>Compute</code>的作用是将交叉类型合并。</p> <h3 id="merge"><a href="#merge" class="header-anchor">#</a> Merge</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Merge<span class="token operator">&lt;</span><span class="token constant">O1</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span> <span class="token constant">O2</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Compute<span class="token operator">&lt;</span><span class="token constant">O1</span> <span class="token operator">&amp;</span> Omit<span class="token operator">&lt;</span><span class="token constant">O2</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">O1</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token constant">O1</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token constant">O2</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">from</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token constant">R2</span> <span class="token operator">=</span> Merge<span class="token operator">&lt;</span><span class="token constant">O1</span><span class="token punctuation">,</span> <span class="token constant">O2</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// {name: string, id: string, from: string}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>Merge&lt;O1, O2&gt;</code>的作用是将两个对象的属性合并。通过实现可以看出，先忽略掉<code>O2</code>中存在于<code>O1</code>的属性，然后再与<code>O1</code>合并。因此重复的属性是以<code>O1</code>里的类型为准，所以上面示例中<code>id</code>属性是<code>string</code>类型。</p> <h3 id="extract"><a href="#extract" class="header-anchor">#</a> Extract</h3> <p>Extract from T those types that are assignable to U.也就是提取<code>T</code>中可以赋值给<code>U</code>的属性。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Extract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="intersection"><a href="#intersection" class="header-anchor">#</a> Intersection</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Intersection<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span> <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span>
  <span class="token constant">T</span><span class="token punctuation">,</span>
  Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> Extract<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">U</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> Props <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> visible<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> DefaultProps <span class="token operator">=</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> DuplicatedProps <span class="token operator">=</span> Intersection<span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> DefaultProps<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// { age: number; }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>Intersection&lt;T, U&gt;</code>的作用是取<code>T</code>的属性，此属性同样也存在与<code>U</code> 。</p> <p>通过实现可以看出，先提取公用的属性，然后从<code>T</code>中进行取出。因此同样属性名的，以<code>T</code>为准。</p> <h3 id="overwrite"><a href="#overwrite" class="header-anchor">#</a> Overwrite</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Overwrite<span class="token operator">&lt;</span>
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span>
  <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token class-name">object</span><span class="token punctuation">,</span>
  <span class="token constant">I</span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> Intersection<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span>
<span class="token operator">&gt;</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">I</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> <span class="token constant">I</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">// From T, pick a set of properties whose keys are in the union K</span>
<span class="token keyword">type</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>Overwrite&lt;T, U&gt;</code>顾名思义,是用<code>U</code>的属性覆盖<code>T</code>的相同属性。</p> <p>通过属性可以看出，核心实现是<code>Diff&lt;T, U&gt; &amp; Intersection&lt;U, T&gt;</code> 。将<strong>差集</strong>和<strong>交集</strong>进行<strong>交叉</strong>，交集以<code>U</code>中属性的类型为准。然后将交叉类型进行<code>Pick</code>。</p> <h3 id="mutable"><a href="#mutable" class="header-anchor">#</a> Mutable</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">type</span> Mutable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span> <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token plain-text">

// Make all properties in T readonly
type Readonly</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">T</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> = </span><span class="token punctuation">{</span>
    <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token plain-text">;
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>Mutable</code>将 <code>T</code> 的所有属性的 <code>readonly</code> 移除。</p> <h3 id="record"><a href="#record" class="header-anchor">#</a> Record</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// Construct a type with a set of properties K of type T</span>
<span class="token keyword">type</span> Record<span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token constant">K</span> <span class="token operator">=</span> <span class="token string">'A'</span> <span class="token operator">|</span> <span class="token string">'B'</span> <span class="token operator">|</span> <span class="token string">'C'</span><span class="token punctuation">;</span>

<span class="token comment">// {A: {id: number}, B: {id: number}, C: {id: number}}</span>
<span class="token keyword">type</span> result <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>Record</code> 允许从 <code>Union</code> 类型中创建新类型，<code>Union</code> 类型中的值用作新类型的属性。</p> <p>学习类型工具，可以阅读<a href="https://github.com/piotrwitek/utility-types" target="_blank" rel="noopener noreferrer">utility-types<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>和<a href="https://github.com/type-challenges/type-challenges" target="_blank" rel="noopener noreferrer">type-challenges<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="编译器"><a href="#编译器" class="header-anchor">#</a> 编译器</h2> <p><code>TypeScript</code>有自己的<strong>编译器</strong>,这个编译器主要有以下部分组成：</p> <ul><li>Scanner 扫描器</li> <li>Parser 解析器</li> <li>Binder 绑定器</li> <li>Emitter 发射器</li> <li>Checker 检查器</li></ul> <p><strong>扫描器</strong>通过扫描源代码生成token流：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>SourceCode（源码）+ 扫描器 --&gt; Token 流
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>解析器</strong>将token流解析为抽象语法树(AST)：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>Token 流 + 解析器 --&gt; AST（抽象语法树）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>绑定器</strong>将AST中的声明节点与相同实体的其他声明相连形成符号(Symbols),符号是语义系统的主要构造块：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>AST + 绑定器 --&gt; Symbols（符号）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>检查器</strong>通过符号和AST来验证源代码语义：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>AST + 符号 + 检查器 --&gt; 类型验证
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后我们通过<strong>发射器</strong>生成JavaScript代码：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>AST + 检查器 + 发射器 --&gt; JavaScript 代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="编写声明文件"><a href="#编写声明文件" class="header-anchor">#</a> 编写声明文件</h2> <h3 id="使用第三方d-ts"><a href="#使用第三方d-ts" class="header-anchor">#</a> 使用第三方d.ts</h3> <p><code>Github</code> 上有一个库<a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="noopener noreferrer">DefinitelyTyped<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>它定义了市面上主流的<code>JavaScript</code> 库的 <code>d.ts</code> ,而且我们可以很方便地用 <code>npm</code>引入这些 <code>d.ts</code>。</p> <p>同时可以通过<a href="https://www.typescriptlang.org/dt/search" target="_blank" rel="noopener noreferrer">search<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来搜索使用的库是否具有声明文件。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code>npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev @types<span class="token operator">/</span>node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果没有第三方的声明文件，就需要手动编写<code>d.ts</code>文件。</p> <h3 id="编写d-ts文件"><a href="#编写d-ts文件" class="header-anchor">#</a> 编写d.ts文件</h3> <p>关键字 <code>declare</code> 表示声明的意思，我们可以用它来做出各种声明：</p> <ul><li><code>declare var</code> 声明全局变量</li> <li><code>declare function</code> 声明全局方法</li> <li><code>declare class</code> 声明全局类</li> <li><code>declare enum</code> 声明全局枚举类型</li> <li><code>declare namespace</code> 声明（含有子属性的）全局对象</li> <li><code>interface</code> 和 <code>type</code> 声明全局类型</li></ul> <h3 id="声明变量"><a href="#声明变量" class="header-anchor">#</a> 声明变量</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token function-variable function">jQuery</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">selector<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="声明函数"><a href="#声明函数" class="header-anchor">#</a> 声明函数</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="声明类"><a href="#声明类" class="header-anchor">#</a> 声明类</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">declare</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="声明枚举"><a href="#声明枚举" class="header-anchor">#</a> 声明枚举</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">declare</span> <span class="token keyword">enum</span> Directions <span class="token punctuation">{</span>
  Up<span class="token punctuation">,</span>
  Down<span class="token punctuation">,</span>
  Left<span class="token punctuation">,</span>
  Right
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="声明interface-和-type"><a href="#声明interface-和-type" class="header-anchor">#</a> 声明interface 和 type</h3> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">interface</span> <span class="token class-name">AjaxSettings</span> <span class="token punctuation">{</span>
    method<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'GET'</span> <span class="token operator">|</span> <span class="token string">'POST'</span>
    data<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> jQuery <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> settings<span class="token operator">?</span><span class="token operator">:</span> AjaxSettings</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="声明合并"><a href="#声明合并" class="header-anchor">#</a> 声明合并</h3> <p>可以组合多个声明语句，它们会不冲突的合并起来。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token parameter">selector<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> jQuery <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> settings<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="自动生成声明文件"><a href="#自动生成声明文件" class="header-anchor">#</a> 自动生成声明文件</h3> <p>如果库的源码本身就是由 <code>ts</code> 写的，那么在使用 <code>tsc</code> 脚本将 <code>ts</code> 编译为 <code>js</code> 的时候，添加 <code>declaration</code> 选项，就可以同时也生成 <code>.d.ts</code> 声明文件了。</p> <p>我们可以在命令行中添加 <code>--declaration</code>（简写 <code>-d</code>），或者在 <code>tsconfig.json</code> 中添加 <code>declaration</code> 选项。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 输出目录</span>
        <span class="token string">&quot;declaration&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 生成声明文件</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="手写events声明文件"><a href="#手写events声明文件" class="header-anchor">#</a> 手写events声明文件</h2> <p>Node's event emitter for all engines.仓库地址为：<a href="https://github.com/browserify/events" target="_blank" rel="noopener noreferrer">event<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>声明文件放至项目的根目录下，命名为<code>index.d.ts</code> 。</p> <div class="language-tsx line-numbers-mode"><pre class="language-tsx"><code><span class="token comment">// index.d.ts</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token function-variable function">Listener</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> Type <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">symbol</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">listenerCount</span><span class="token punctuation">(</span>emitter<span class="token operator">:</span> EventEmitter<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token operator">:</span> Type<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> defaultMaxListeners<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token function">eventNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Array</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Type</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;
  setMaxListeners(n: number): this;
  getMaxListeners(): number;
  emit(type: Type, ...args: any[]): boolean;
  addListener(type: Type, listener: Listener): this;
  on(type: Type, listener: Listener): this;
  once(type: Type, listener: Listener): this;
  prependOnceListener(type: Type, listener: Listener): this;
  removeListener(type: Type, listener: Listener): this;
  off(type: Type, listener: Listener): this;
  removeAllListeners(type?: Type): this;
  listeners(type: Type): Listener[];
  listenerCount(type: Type): number;
  prependListener(type: Type, listener: Listener): this;
  rawListeners(type: Type): Listener[];
}
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="tsconfig-json"><a href="#tsconfig-json" class="header-anchor">#</a> tsconfig.json</h2> <p><code>tsconfig.json</code>详细配置说明。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">/* Basic Options */</span>
    <span class="token string">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es5&quot;</span> <span class="token comment">/* target用于指定编译之后的版本目标: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', 'ES2018', 'ES2019' or 'ESNEXT'. */</span><span class="token punctuation">,</span>
    <span class="token string">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span> <span class="token comment">/* 用来指定要使用的模块标准: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'. */</span><span class="token punctuation">,</span>
    <span class="token string">&quot;lib&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">]</span> <span class="token comment">/* lib用于指定要包含在编译中的库文件 */</span><span class="token punctuation">,</span>
    <span class="token string">&quot;allowJs&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                       <span class="token comment">/* allowJs设置的值为true或false，用来指定是否允许编译js文件，默认是false，即不编译js文件 */</span>
    <span class="token string">&quot;checkJs&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                       <span class="token comment">/* checkJs的值为true或false，用来指定是否检查和报告js文件中的错误，默认是false */</span>
    <span class="token string">&quot;jsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;preserve&quot;</span><span class="token punctuation">,</span>                     <span class="token comment">/* 指定jsx代码用于的开发环境: 'preserve', 'react-native', or 'react'. */</span>
    <span class="token string">&quot;declaration&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                   <span class="token comment">/* declaration的值为true或false，用来指定是否在编译的时候生成相应的&quot;.d.ts&quot;声明文件。如果设为true，编译每个ts文件之后会生成一个js文件和一个声明文件。但是declaration和allowJs不能同时设为true */</span>
    <span class="token string">&quot;declarationMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token comment">/* 值为true或false，指定是否为声明文件.d.ts生成map文件 */</span>
    <span class="token string">&quot;sourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                     <span class="token comment">/* sourceMap的值为true或false，用来指定编译时是否生成.map文件 */</span>
    <span class="token string">&quot;outFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist/main.js&quot;</span><span class="token punctuation">,</span>           <span class="token comment">/* outFile用于指定将输出文件合并为一个文件，它的值为一个文件路径名。比如设置为&quot;./dist/main.js&quot;，则输出的文件为一个main.js文件。但是要注意，只有设置module的值为amd和system模块时才支持这个配置 */</span>
    <span class="token string">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span>                    <span class="token comment">/* outDir用来指定输出文件夹，值为一个文件夹路径字符串，输出的文件都将放置在这个文件夹 */</span>
    <span class="token string">&quot;rootDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>                       <span class="token comment">/* 用来指定编译文件的根目录，编译器会在根目录查找入口文件，如果编译器发现以rootDir的值作为根目录查找入口文件并不会把所有文件加载进去的话会报错，但是不会停止编译 */</span>
    <span class="token string">&quot;composite&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                     <span class="token comment">/* 是否编译构建引用项目  */</span>
    <span class="token string">&quot;removeComments&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token comment">/* removeComments的值为true或false，用于指定是否将编译后的文件中的注释删掉，设为true的话即删掉注释，默认为false */</span>
    <span class="token string">&quot;noEmit&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                        <span class="token comment">/* 不生成编译文件，这个一般比较少用 */</span>
    <span class="token string">&quot;importHelpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">/* importHelpers的值为true或false，指定是否引入tslib里的辅助工具函数，默认为false */</span>
    <span class="token string">&quot;downlevelIteration&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">/* 当target为'ES5' or 'ES3'时，为'for-of', spread, and destructuring'中的迭代器提供完全支持 */</span>
    <span class="token string">&quot;isolatedModules&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>               <span class="token comment">/* isolatedModules的值为true或false，指定是否将每个文件作为单独的模块，默认为true，它不可以和declaration同时设定 */</span>

    <span class="token comment">/* Strict Type-Checking Options */</span>
    <span class="token string">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">/* strict的值为true或false，用于指定是否启动所有类型检查，如果设为true则会同时开启下面这几个严格类型检查，默认为false */</span><span class="token punctuation">,</span>
    <span class="token string">&quot;noImplicitAny&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">/* noImplicitAny的值为true或false，如果我们没有为一些值设置明确的类型，编译器会默认认为这个值为any，如果noImplicitAny的值为true的话。则没有明确的类型会报错。默认值为false */</span>
    <span class="token string">&quot;strictNullChecks&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">/* strictNullChecks为true时，null和undefined值不能赋给非这两种类型的值，别的类型也不能赋给他们，除了any类型。还有个例外就是undefined可以赋值给void类型 */</span>
    <span class="token string">&quot;strictFunctionTypes&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>           <span class="token comment">/* strictFunctionTypes的值为true或false，用于指定是否使用函数参数双向协变检查 */</span>
    <span class="token string">&quot;strictBindCallApply&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>           <span class="token comment">/* 设为true后会对bind、call和apply绑定的方法的参数的检测是严格检测的 */</span>
    <span class="token string">&quot;strictPropertyInitialization&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">/* 设为true后会检查类的非undefined属性是否已经在构造函数里初始化，如果要开启这项，需要同时开启strictNullChecks，默认为false */</span>
    <span class="token string">&quot;noImplicitThis&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">/* 当this表达式的值为any类型的时候，生成一个错误 */</span>
    <span class="token string">&quot;alwaysStrict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                  <span class="token comment">/* alwaysStrict的值为true或false，指定始终以严格模式检查每个模块，并且在编译之后的js文件中加入&quot;use strict&quot;字符串，用来告诉浏览器该js为严格模式 */</span>

    <span class="token comment">/* Additional Checks */</span>
    <span class="token string">&quot;noUnusedLocals&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                <span class="token comment">/* 用于检查是否有定义了但是没有使用的变量，对于这一点的检测，使用eslint可以在你书写代码的时候做提示，你可以配合使用。它的默认值为false */</span>
    <span class="token string">&quot;noUnusedParameters&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">/* 用于检查是否有在函数体中没有使用的参数，这个也可以配合eslint来做检查，默认为false */</span>
    <span class="token string">&quot;noImplicitReturns&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">/* 用于检查函数是否有返回值，设为true后，如果函数没有返回值则会提示，默认为false */</span>
    <span class="token string">&quot;noFallthroughCasesInSwitch&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">/* 用于检查switch中是否有case没有使用break跳出switch，默认为false */</span>

    <span class="token comment">/* Module Resolution Options */</span>
    <span class="token string">&quot;moduleResolution&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span>            <span class="token comment">/* 用于选择模块解析策略，有'node'和'classic'两种类型' */</span>
    <span class="token string">&quot;baseUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>                       <span class="token comment">/* baseUrl用于设置解析非相对模块名称的基本目录，相对模块不会受baseUrl的影响 */</span>
    <span class="token string">&quot;paths&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                           <span class="token comment">/* 用于设置模块名称到基于baseUrl的路径映射 */</span>
    <span class="token string">&quot;rootDirs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                        <span class="token comment">/* rootDirs可以指定一个路径列表，在构建时编译器会将这个路径列表中的路径的内容都放到一个文件夹中 */</span>
    <span class="token string">&quot;typeRoots&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                       <span class="token comment">/* typeRoots用来指定声明文件或文件夹的路径列表，如果指定了此项，则只有在这里列出的声明文件才会被加载 */</span>
    <span class="token string">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                           <span class="token comment">/* types用来指定需要包含的模块，只有在这里列出的模块的声明文件才会被加载进来 */</span>
    <span class="token string">&quot;allowSyntheticDefaultImports&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">/* 用来指定允许从没有默认导出的模块中默认导入 */</span>
    <span class="token string">&quot;esModuleInterop&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">/* 通过为导入内容创建命名空间，实现CommonJS和ES模块之间的互操作性 */</span><span class="token punctuation">,</span>
    <span class="token string">&quot;preserveSymlinks&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">/* 不把符号链接解析为其真实路径，具体可以了解下webpack和nodejs的symlink相关知识 */</span>

    <span class="token comment">/* Source Map Options */</span>
    <span class="token string">&quot;sourceRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                      <span class="token comment">/* sourceRoot用于指定调试器应该找到TypeScript文件而不是源文件位置，这个值会被写进.map文件里 */</span>
    <span class="token string">&quot;mapRoot&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                         <span class="token comment">/* mapRoot用于指定调试器找到映射文件而非生成文件的位置，指定map文件的根路径，该选项会影响.map文件中的sources属性 */</span>
    <span class="token string">&quot;inlineSourceMap&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>               <span class="token comment">/* 指定是否将map文件的内容和js文件编译在同一个js文件中，如果设为true，则map的内容会以//# sourceMappingURL=然后拼接base64字符串的形式插入在js文件底部 */</span>
    <span class="token string">&quot;inlineSources&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                 <span class="token comment">/* 用于指定是否进一步将.ts文件的内容也包含到输入文件中 */</span>

    <span class="token comment">/* Experimental Options */</span>
    <span class="token string">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>         <span class="token comment">/* 用于指定是否启用实验性的装饰器特性 */</span>
    <span class="token string">&quot;emitDecoratorMetadata&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>         <span class="token comment">/* 用于指定是否为装饰器提供元数据支持，关于元数据，也是ES6的新标准，可以通过Reflect提供的静态方法获取元数据，如果需要使用Reflect的一些方法，需要引入ES2015.Reflect这个库 */</span>
  <span class="token punctuation">}</span>
  <span class="token string">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// files可以配置一个数组列表，里面包含指定文件的相对或绝对路径，编译器在编译的时候只会编译包含在files中列出的文件，如果不指定，则取决于有没有设置include选项，如果没有include选项，则默认会编译根目录以及所有子目录中的文件。这里列出的路径必须是指定文件，而不是某个文件夹，而且不能使用* ? **/ 等通配符</span>
  <span class="token string">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// include也可以指定要编译的路径列表，但是和files的区别在于，这里的路径可以是文件夹，也可以是文件，可以使用相对和绝对路径，而且可以使用通配符，比如&quot;./src&quot;即表示要编译src文件夹下的所有文件以及子文件夹的文件</span>
  <span class="token string">&quot;exclude&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// exclude表示要排除的、不编译的文件，它也可以指定一个列表，规则和include一样，可以是文件或文件夹，可以是相对路径或绝对路径，可以使用通配符</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// extends可以通过指定一个其他的tsconfig.json文件路径，来继承这个配置文件里的配置，继承来的文件的配置会覆盖当前文件定义的配置。TS在3.2版本开始，支持继承一个来自Node.js包的tsconfig.json配置文件</span>
  <span class="token string">&quot;compileOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// compileOnSave的值是true或false，如果设为true，在我们编辑了项目中的文件保存的时候，编辑器会根据tsconfig.json中的配置重新生成文件，不过这个要编辑器支持</span>
  <span class="token string">&quot;references&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 一个对象数组，指定要引用的项目</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><h2 id="eslint"><a href="#eslint" class="header-anchor">#</a> ESLint</h2> <p>全局安装<code>eslint</code>。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>npm install <span class="token operator">-</span>g eslint
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>初始化配置文件。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>eslint <span class="token operator">--</span>init
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>选择TS和Airbnb风格代码校验，会生成<code>.eslintrc.js</code> ：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  env<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 用于指定环境</span>
    browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    es6<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    node<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 字符串或字符串数组，数组中每个配置项继承它前面的配置。</span>
    <span class="token string">'airbnb-base'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  globals<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 脚本在执行期间访问的额外的全局变量</span>
    Atomics<span class="token operator">:</span> <span class="token string">'readonly'</span><span class="token punctuation">,</span>
    SharedArrayBuffer<span class="token operator">:</span> <span class="token string">'readonly'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  parser<span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span> <span class="token comment">// 解析器</span>
  parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// parser 解析代码时的配置参数</span>
    ecmaVersion<span class="token operator">:</span> <span class="token number">2020</span><span class="token punctuation">,</span> <span class="token comment">// 指定es版本</span>
    sourceType<span class="token operator">:</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token comment">// 指定资源类型为ECMAScript 模块</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 第三方插件，插件名称可以省略 eslint-plugin- 前缀</span>
    <span class="token string">'@typescript-eslint'</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 具体规则的配置，可以用来进行覆盖或者修改指定规则</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>eslint的配置文件可以是以下形式：</p> <ul><li><code>.eslintrc.js</code>(输出一个配置对象)</li> <li><code>.eslintrc.yaml</code></li> <li><code>.eslintrc.yml</code></li> <li><code>.eslintrc.json</code>（<code>ESLint</code>的<code>JSON</code>文件允许<code>JavaScript</code>风格的注释）</li> <li><code>.eslintrc</code>（可以是<code>JSON</code>也可以是<code>YAML</code>）</li> <li><code>package.json</code>（在<code>package.json</code>里创建一个<code>eslintConfig</code>属性，在那里定义你的配置）</li></ul> <p>优先级按顺序由高到低。</p> <p><code>extend</code>和<code>plugin</code>的区别：</p> <p><code>extend</code>提供的是 <code>eslint</code>现有规则的一系列<strong>预设</strong>，而 <code>plugin</code> 则提供了除预设之外的<strong>自定义规则</strong>，当你在 <code>eslint</code> 的规则里找不到合适的的时候，就可以借用插件来实现。</p> <h3 id="eslint总结"><a href="#eslint总结" class="header-anchor">#</a> eslint总结</h3> <ul><li><code>env</code>: 预定义那些环境需要用到的全局变量，可用的参数是：<code>es6</code>、<code>broswer</code>、<code>node</code>等</li> <li><code>extends</code>: 指定扩展的配置，配置支持递归扩展，支持规则的覆盖和聚合</li> <li><code>plugins</code>: 配置那些我们想要<code>Linting</code>规则的插件。</li> <li><code>parser</code>: 默认<code>ESlint</code>使用<code>Espree</code>作为解析器，我们也可以用其他解析器在此配置</li> <li><code>parserOptions</code>: 解析器的配置项</li> <li><code>rules</code>: 自定义规则，可以覆盖掉<code>extends</code>的配置</li> <li><code>globals</code>： 脚本在执行期间访问的额外的全局变量</li></ul> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>以上就是通读完小册后整理的笔记，接下来要开始通读<code>TypeScript</code>官方文档，下篇见。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/FrontToEnd/vuepress-blog/edit/main/notes/深入浅出TypeScript.md" target="_blank" rel="noopener noreferrer">帮助我改善这个页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">1/15/2022, 9:35:07 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/notes/工具库源码解析.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        工具库源码解析
      </a></span> <!----></p></div> </main> <!----></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.3f4decce.js" defer></script><script src="/assets/js/2.bdf3ae06.js" defer></script><script src="/assets/js/91.d36166a4.js" defer></script>
  </body>
</html>