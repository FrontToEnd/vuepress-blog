<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>工具库源码解析 | chuck</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="hi，我是chuck。一名F2Eer">
    <link rel="preload" href="/assets/css/0.styles.077cbd51.css" as="style"><link rel="preload" href="/assets/js/app.3f4decce.js" as="script"><link rel="preload" href="/assets/js/2.bdf3ae06.js" as="script"><link rel="preload" href="/assets/js/90.86e48091.js" as="script"><link rel="prefetch" href="/assets/js/10.eada5689.js"><link rel="prefetch" href="/assets/js/11.8c577c64.js"><link rel="prefetch" href="/assets/js/12.b6715b7f.js"><link rel="prefetch" href="/assets/js/13.910bf70c.js"><link rel="prefetch" href="/assets/js/14.68fc43ad.js"><link rel="prefetch" href="/assets/js/15.7cafe28c.js"><link rel="prefetch" href="/assets/js/16.eb15a660.js"><link rel="prefetch" href="/assets/js/17.79874611.js"><link rel="prefetch" href="/assets/js/18.2ab1affb.js"><link rel="prefetch" href="/assets/js/19.a392eb25.js"><link rel="prefetch" href="/assets/js/20.712152d5.js"><link rel="prefetch" href="/assets/js/21.2c108029.js"><link rel="prefetch" href="/assets/js/22.7de1fb97.js"><link rel="prefetch" href="/assets/js/23.538fba8a.js"><link rel="prefetch" href="/assets/js/24.678c9407.js"><link rel="prefetch" href="/assets/js/25.95daf731.js"><link rel="prefetch" href="/assets/js/26.06fc523b.js"><link rel="prefetch" href="/assets/js/27.7e0e331d.js"><link rel="prefetch" href="/assets/js/28.dc5b365e.js"><link rel="prefetch" href="/assets/js/29.9876fc9b.js"><link rel="prefetch" href="/assets/js/3.e38b8b6f.js"><link rel="prefetch" href="/assets/js/30.3c5f94d7.js"><link rel="prefetch" href="/assets/js/31.ff6971b6.js"><link rel="prefetch" href="/assets/js/32.4d4bceac.js"><link rel="prefetch" href="/assets/js/33.82501ef2.js"><link rel="prefetch" href="/assets/js/34.a835b6a0.js"><link rel="prefetch" href="/assets/js/35.1c57dbf3.js"><link rel="prefetch" href="/assets/js/36.3f372679.js"><link rel="prefetch" href="/assets/js/37.1af4a03d.js"><link rel="prefetch" href="/assets/js/38.f1081cb6.js"><link rel="prefetch" href="/assets/js/39.fa03e4b7.js"><link rel="prefetch" href="/assets/js/4.3716397f.js"><link rel="prefetch" href="/assets/js/40.b860044e.js"><link rel="prefetch" href="/assets/js/41.86185343.js"><link rel="prefetch" href="/assets/js/42.0c0075b6.js"><link rel="prefetch" href="/assets/js/43.4e9ee742.js"><link rel="prefetch" href="/assets/js/44.65b2ce39.js"><link rel="prefetch" href="/assets/js/45.422be1f9.js"><link rel="prefetch" href="/assets/js/46.66c8b9f3.js"><link rel="prefetch" href="/assets/js/47.74e48322.js"><link rel="prefetch" href="/assets/js/48.866b5c4b.js"><link rel="prefetch" href="/assets/js/49.2331c42e.js"><link rel="prefetch" href="/assets/js/5.adc84131.js"><link rel="prefetch" href="/assets/js/50.01a479db.js"><link rel="prefetch" href="/assets/js/51.b46902c4.js"><link rel="prefetch" href="/assets/js/52.2e323837.js"><link rel="prefetch" href="/assets/js/53.04a399ba.js"><link rel="prefetch" href="/assets/js/54.392b71cd.js"><link rel="prefetch" href="/assets/js/55.1837e036.js"><link rel="prefetch" href="/assets/js/56.0900b3fe.js"><link rel="prefetch" href="/assets/js/57.94ca5c07.js"><link rel="prefetch" href="/assets/js/58.fdc2f5a1.js"><link rel="prefetch" href="/assets/js/59.da6b8b43.js"><link rel="prefetch" href="/assets/js/6.f4b3b355.js"><link rel="prefetch" href="/assets/js/60.2c6c08df.js"><link rel="prefetch" href="/assets/js/61.4bcf8e3a.js"><link rel="prefetch" href="/assets/js/62.6a815ac4.js"><link rel="prefetch" href="/assets/js/63.841a7f63.js"><link rel="prefetch" href="/assets/js/64.42844f28.js"><link rel="prefetch" href="/assets/js/65.6bb320a1.js"><link rel="prefetch" href="/assets/js/66.7f0781a0.js"><link rel="prefetch" href="/assets/js/67.9999f087.js"><link rel="prefetch" href="/assets/js/68.be67ff7c.js"><link rel="prefetch" href="/assets/js/69.270a4048.js"><link rel="prefetch" href="/assets/js/7.00249ed3.js"><link rel="prefetch" href="/assets/js/70.7e58fdde.js"><link rel="prefetch" href="/assets/js/71.737dc345.js"><link rel="prefetch" href="/assets/js/72.2d565df3.js"><link rel="prefetch" href="/assets/js/73.4cf51495.js"><link rel="prefetch" href="/assets/js/74.1aa0e1bf.js"><link rel="prefetch" href="/assets/js/75.e0e34199.js"><link rel="prefetch" href="/assets/js/76.82acf861.js"><link rel="prefetch" href="/assets/js/77.e589714d.js"><link rel="prefetch" href="/assets/js/78.8e9abadd.js"><link rel="prefetch" href="/assets/js/79.9e1fc178.js"><link rel="prefetch" href="/assets/js/8.703362e2.js"><link rel="prefetch" href="/assets/js/80.2a43e147.js"><link rel="prefetch" href="/assets/js/81.ca7bc668.js"><link rel="prefetch" href="/assets/js/82.c9e21c1b.js"><link rel="prefetch" href="/assets/js/83.a975c135.js"><link rel="prefetch" href="/assets/js/84.365e7338.js"><link rel="prefetch" href="/assets/js/85.64af8645.js"><link rel="prefetch" href="/assets/js/86.1b0bd26b.js"><link rel="prefetch" href="/assets/js/87.dde120f2.js"><link rel="prefetch" href="/assets/js/88.32dc5669.js"><link rel="prefetch" href="/assets/js/89.446a8227.js"><link rel="prefetch" href="/assets/js/9.7089b1f5.js"><link rel="prefetch" href="/assets/js/91.d36166a4.js"><link rel="prefetch" href="/assets/js/92.2aa12fec.js">
    <link rel="stylesheet" href="/assets/css/0.styles.077cbd51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="ant-row"><div class="nav-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/" class="router-link-active home-link"><img src="/img/logo.png" alt="chuck" class="logo"> <span class="site-name">chuck</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/" class="router-link-active">
          🍧首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/guide/">
          🏆规范
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/article/">
          📒文章
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item ant-menu-item-selected"><a href="/notes/" class="router-link-active">
          📚笔记
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/algorithm/">
          🌲算法
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          🌈联系
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <a href="https://github.com/FrontToEnd/vuepress-blog" target="_blank" rel="noopener noreferrer" class="repo-link"><i aria-label="icon: github" class="anticon anticon-github"><svg viewBox="64 64 896 896" focusable="false" data-icon="github" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></i></a></nav></div></div> <!----></header> <aside class="sidebar"><!----> <ul class="sidebar-links"><li><a href="/notes/阅读Mijin有感.html" title="阅读Mijin有感" class="sidebar-link">阅读Mijin有感</a></li><li><a href="/notes/如何学习前端.html" title="如何学习前端" class="sidebar-link">如何学习前端</a></li><li><a href="/notes/工具库源码解析.html" title="工具库源码解析" class="active sidebar-link">工具库源码解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/工具库源码解析.html#安装" title="安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/notes/工具库源码解析.html#使用" title="使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/notes/工具库源码解析.html#api" title="API" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/notes/工具库源码解析.html#总结" title="总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/notes/深入浅出TypeScript.html" title="深入浅出TypeScript" class="sidebar-link">深入浅出TypeScript</a></li></ul></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="工具库源码解析"><a href="#工具库源码解析" class="header-anchor">#</a> 工具库源码解析</h1> <p>在日常开发中，我们会经常遇到转换固定格式或者生成指定格式的需求，比如生成随机颜色，判断是否为邮箱、身份证等等。那么今天就来分析一下<code>github</code> 的开源库<a href="https://github.com/proYang/outils" title="outils" target="_blank" rel="noopener noreferrer">outils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <ol><li>直接下载<code>min</code>目录下的<a href="https://github.com/proYang/outils/blob/master/min/outils.min.js" title="outils.min.js" target="_blank" rel="noopener noreferrer">outils.min.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>使用，支持 UMD 通用模块规范。</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>outils.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> <span class="token constant">OS</span> <span class="token operator">=</span> outils<span class="token punctuation">.</span><span class="token function">getOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>使用 npm 安装</li></ol> <div class="language-html line-numbers-mode"><pre class="language-html"><code>npm install --save-dev outils
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h2> <p>推荐按需引入。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// 只引入部分方法('outils/&lt;方法名&gt;')</span>
<span class="token keyword">const</span> getOS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;outils/getOS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">OS</span> <span class="token operator">=</span> <span class="token function">getOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <p>接下来就逐一进行 API 的解读与源码分析。</p> <h3 id="arrayequal"><a href="#arrayequal" class="header-anchor">#</a> arrayEqual</h3> <p><strong>判断两个数组是否相等。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description 判断两个数组是否相等
 * @param {Array} arr1
 * @param {Array} arr2
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">arrayEqual</span><span class="token punctuation">(</span><span class="token parameter">arr1<span class="token punctuation">,</span> arr2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果两个数组是同一引用，则意味着相等</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr1 <span class="token operator">===</span> arr2<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果数组长度不同，则不相等</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr1<span class="token punctuation">.</span>length <span class="token operator">!==</span> arr2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果数组的某一项不同，则不相等</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 否则意味着相等</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="hasclass"><a href="#hasclass" class="header-anchor">#</a> hasClass</h3> <p><strong>判断元素是否有某个<code>class</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 判断元素是否有某个class
 * @param {HTMLElement} ele
 * @param {String} cls
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> cls</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过正则判断元素的className属性中是否存在指定的类名</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(\\s|^)&quot;</span> <span class="token operator">+</span> cls <span class="token operator">+</span> <span class="token string">&quot;(\\s|$)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ele<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="addclass"><a href="#addclass" class="header-anchor">#</a> addClass</h3> <p><strong>为元素添加<code>class</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description 为元素添加class
 * @param {HTMLElement} ele
 * @param {String} cls
 */</span>

<span class="token keyword">var</span> hasClass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./hasClass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">addClass</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> cls</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果元素中不存在指定类名则添加</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasClass</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 添加方式是在元素的className属性后面追加指定类名</span>
    <span class="token comment">// 不要忘记加上空格，因为类名以空格区分</span>
    ele<span class="token punctuation">.</span>className <span class="token operator">+=</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> cls<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="removeclass"><a href="#removeclass" class="header-anchor">#</a> removeClass</h3> <p><strong>为元素移除<code>class</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 为元素移除class
 * @param {HTMLElement} ele
 * @param {String} cls
 */</span>

<span class="token keyword">var</span> hasClass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./hasClass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token parameter">ele<span class="token punctuation">,</span> cls</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果元素存在指定类名，方可移除</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasClass</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> cls<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 声明获取类名的正则</span>
    <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(\\s|^)&quot;</span> <span class="token operator">+</span> cls <span class="token operator">+</span> <span class="token string">&quot;(\\s|$)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 使用字符串的replace方法将类名替换为空格字符串</span>
    <span class="token comment">// 最终的className可能会有多个空格，HTML规范接受多个空格</span>
    ele<span class="token punctuation">.</span>className <span class="token operator">=</span> ele<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="getcookie"><a href="#getcookie" class="header-anchor">#</a> getCookie</h3> <p>下面三个方法涉及到操作<code>cookie</code>，关于<code>cookie</code>的知识可以另起一篇文章了，我们下回接说。本文先讲解方法。</p> <p><strong>根据<code>name</code>读取<code>Cookie</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 根据name读取cookie
 * @param  {String} name
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取cookie去除空格后，通过';'分割为键值对(key=value)数组</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\s/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分割键值对(key=value)数组。第一项为key，第二项为value</span>
    <span class="token keyword">var</span> tempArr <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果指定name与key相同则返回指定value。这里没有使用恒等，应该是为了兼容隐式转换</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tempArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// cookie的value会进行编码，因此需要调用API进行解码并返回</span>
      <span class="token keyword">return</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>tempArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>tips:</strong></p> <p><code>encodeURI()</code>不会对本身属于 URI 的特殊字符进行编码，例如冒号、正斜杠、问号和井字号；而<code>encodeURIComponent()</code>则会对它发现的<strong>任何非标准字符</strong>进行编码(替换所有非字母数字字符)。因此使用后者可以编码更多的字符，防止 XSS 攻击。同样的，解码就需要使用对应的方法<code>decodeURIComponent()</code> 。</p> <h3 id="setcookie"><a href="#setcookie" class="header-anchor">#</a> setCookie</h3> <p><strong>设置<code>cookie</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description  设置Cookie
 * @param {String} name
 * @param {String} value
 * @param {Number} days
 */</span>
<span class="token keyword">function</span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> days</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 根据当地时间获取指定日期，加上days参数后，再更改日期。</span>
  date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> days<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 设置指定的key=value，并且加上过期时间</span>
  document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">&quot;;expires=&quot;</span> <span class="token operator">+</span> date<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>补充几个知识点：</p> <p>1、<code>Date.prototype.getDate()</code> 返回当地时间下指定月份的日期。比如今天是<code>2022-01-02</code>，该方法会返回数字<code>2</code> 。返回值是介于<code>1-31</code>的整数。</p> <p>2、<code>Date.prototype.setDate()</code> 更改当地时间下指定月份的日期。接收的参数是月份日期的整数值。</p> <p>3、设置<code>cookie</code>可以直接赋值给<code>document.cookie</code> ，此时会新增一条<code>cookie</code>，而不是覆盖已有的。设置过期时间的方法就是增加<code>expires</code>属性。该属性的值就是<strong>世界标准时间（UTC）</strong>。</p> <p>4、JavaScript 的时间由**世界标准时间（UTC）**1970 年 1 月 1 日开始，用毫秒计时，一天由 <strong>86,400,000</strong> 毫秒组成。<code>Date</code>  对象的范围是 <strong>-100,000,000</strong> 天至 <strong>100,000,000</strong> 天（等效的毫秒值）。</p> <p>5、以一个函数的形式来调用  <code>Date</code>  对象（即不使用  <code>new</code>  操作符）会返回一个代表当前日期和时间的<strong>字符串</strong>。</p> <h3 id="removecookie"><a href="#removecookie" class="header-anchor">#</a> removeCookie</h3> <p><strong>根据<code>name</code>删除<code>cookie</code>。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 根据name删除cookie
 * @param  {String} name
 */</span>
<span class="token keyword">var</span> setCookie <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./setCookie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">removeCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 设置已过期，系统会立刻删除cookie</span>
  <span class="token function">setCookie</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="getexplore"><a href="#getexplore" class="header-anchor">#</a> getExplore</h3> <p><strong>获取浏览器的类型和版本。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 获取浏览器类型和版本
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">getExplore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> sys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    s<span class="token punctuation">;</span>

  <span class="token comment">// 通过正则匹配用户代理字符串，来存储具体的浏览器类型和版本</span>
  <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/rv:([\d.]+)\) like gecko/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>ie <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/msie ([\d\.]+)/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>ie <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/edge\/([\d\.]+)/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>edge <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/firefox\/([\d\.]+)/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>firefox <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/(?:opera|opr).([\d\.]+)/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>opera <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/chrome\/([\d\.]+)/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>chrome <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token punctuation">(</span>s <span class="token operator">=</span> ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/version\/([\d\.]+).*safari/</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>safari <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// 根据关系进行判断</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>ie<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;IE: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>ie<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>edge<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;EDGE: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>edge<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>firefox<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;Firefox: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>firefox<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>chrome<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;Chrome: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>chrome<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>opera<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;Opera: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>opera<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>sys<span class="token punctuation">.</span>safari<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;Safari: &quot;</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>safari<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">&quot;Unkonwn&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>补充知识：</p> <p><code>String.prototype.match()</code> 方法检索返回一个字符串匹配正则表达式的结果。其中，参数为<strong>正则表达式对象</strong>。</p> <p>如果传入一个非正则表达式对象，则会隐式地使用  <code>new RegExp(obj)</code>  将其转换为一个  <code>RegExp</code> 。如果你没有给出任何参数并直接使用<code>match()</code>方法  ，你将会得到一个包含空字符串的数组：<code>[&quot;&quot;]</code> 。</p> <p>返回值分为两种情况：</p> <ul><li>如果使用 g 标志，则将返回与完整正则表达式匹配的<strong>所有结果</strong>，但不会返回捕获组。</li> <li>如果未使用 g 标志，则仅返回<strong>第一个完整</strong>匹配及其相关的捕获组（<code>Array</code>）。</li></ul> <p>上述示例中没有使用全局标志，因此返回第一个完整匹配及其捕获组。打印一下<code>s</code>看看：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token punctuation">[</span><span class="token string">'chrome/96.0.4664.110'</span><span class="token punctuation">,</span> <span class="token string">'96.0.4664.110'</span><span class="token punctuation">,</span> index<span class="token operator">:</span> <span class="token number">87</span><span class="token punctuation">,</span> input<span class="token operator">:</span> <span class="token string">'mozilla/5.0 (macintosh; intel mac os x 10_14_6) applewebkit/537.36 (khtml, like gecko) chrome/96.0.4664.110 safari/537.36'</span><span class="token punctuation">,</span> groups<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回结果是一个<strong>数组</strong>。其中有三个附加属性：</p> <ul><li><code>groups</code>: 一个捕获组数组 或  <code>undefined</code>（如果没有定义命名捕获组）。</li> <li><code>index</code>: 匹配的结果的开始位置。</li> <li><code>input</code>: 搜索的字符串。</li></ul> <p>我们想要得到的浏览器版本就存在于返回结果的第二项。这也是为什么源码里面赋值使用的<code>s[1]</code> 。</p> <p>还有一个有意思的点，当尝试将返回结果进行字符串化，发现结果会省略附加属性。只保留了索引是数字的值。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '[&quot;chrome/96.0.4664.110&quot;,&quot;96.0.4664.110&quot;]'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="getos"><a href="#getos" class="header-anchor">#</a> getOS</h3> <p><strong>获取操作系统类型。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 获取操作系统类型
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">getOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取navigator相关属性，并进行类型保护</span>
  <span class="token keyword">var</span> userAgent <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token string">&quot;navigator&quot;</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span>
      <span class="token string">&quot;userAgent&quot;</span> <span class="token keyword">in</span> navigator <span class="token operator">&amp;&amp;</span>
      navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> vendor <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token string">&quot;navigator&quot;</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span>
      <span class="token string">&quot;vendor&quot;</span> <span class="token keyword">in</span> navigator <span class="token operator">&amp;&amp;</span>
      navigator<span class="token punctuation">.</span>vendor<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> appVersion <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token string">&quot;navigator&quot;</span> <span class="token keyword">in</span> window <span class="token operator">&amp;&amp;</span>
      <span class="token string">&quot;appVersion&quot;</span> <span class="token keyword">in</span> navigator <span class="token operator">&amp;&amp;</span>
      navigator<span class="token punctuation">.</span>appVersion<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 通过正则来判断相关操作系统类型，并返回相关字符串</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token regex">/iphone/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token regex">/ipad/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token regex">/ipod/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ios&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/android/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;android&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/win/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>appVersion<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token regex">/phone/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>userAgent<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;windowsPhone&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/mac/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>appVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;MacOSX&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/win/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>appVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;windows&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/linux/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>appVersion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;linux&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h3 id="getscrolltop"><a href="#getscrolltop" class="header-anchor">#</a> getScrollTop</h3> <p><strong>获取滚动条距顶部的距离。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 获取滚动条距顶部的距离
 */</span>
<span class="token keyword">function</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 优先获取document.documentElement下的属性</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement <span class="token operator">&amp;&amp;</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">)</span> <span class="token operator">||</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>补充知识：</p> <p><strong><code>Document.documentElement</code></strong>  是一个会返回文档对象（<code>document</code>）的<strong>根元素</strong>的<strong>只读</strong>属性（如<code>HTML</code>文档的<code>&lt;html&gt;</code>元素）。</p> <p>对于任何非空 <code>HTML</code> 文档，调用  <code>document.documentElement</code>  总是会返回一个<code>&lt;html&gt;</code>元素，且它一定是该文档的根元素。借助这个只读属性，能方便地获取到任意文档的<code>根元素</code>。</p> <h3 id="setscrolltop"><a href="#setscrolltop" class="header-anchor">#</a> setScrollTop</h3> <p><strong>设置滚动条距顶部的距离。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 设置滚动条距顶部的距离
 * @param {Number} value
 */</span>
<span class="token keyword">function</span> <span class="token function">setScrollTop</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 使用window.scrollTo滚动到距顶部x轴为0，y轴为value的距离</span>
  window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>补充知识：</p> <p>1、<code>Window.scrollTo()</code> 表示滚动到文档中的某个坐标。</p> <p>2、接受两种类型的参数：</p> <ol><li><code>window.scrollTo(x-coord,y-coord)</code> 。其中，第一个参数表示横轴坐标，第二个参数表示纵轴坐标。</li> <li><code>window.scrollTo(options)</code> 。其中，<code>options</code>是一个包含三个属性的对象。
<ol><li><code>top</code> 等同于<code>y-coord</code>。</li> <li><code>left</code>等同于<code>x-coord</code>。</li> <li><code>behavior</code> **类型<code>String</code>,表示滚动行为,支持参数 <code>smooth</code>(平滑滚动),<code>instant</code>(瞬间滚动),默认值<code>auto</code> (效果也是瞬间滚动)。</li></ol></li></ol> <p>举个 🌰：</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置滚动行为改为平滑的滚动</span>
window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  top<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  behavior<span class="token operator">:</span> <span class="token string">&quot;smooth&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="offset"><a href="#offset" class="header-anchor">#</a> offset</h3> <p><strong>获取元素距离文档(<code>document</code>)的位置。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description  获取一个元素的距离文档(document)的位置，类似jQ中的offset()
 * @param {HTMLElement} ele
 * @returns { {left: number, top: number} }
 */</span>
<span class="token keyword">function</span> <span class="token function">offset</span><span class="token punctuation">(</span><span class="token parameter">ele</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> pos <span class="token operator">=</span> <span class="token punctuation">{</span>
        left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        top<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

		<span class="token comment">// 循环获取元素的offsetLeft和offsetTop属性，并累加到pos中</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pos<span class="token punctuation">.</span>left <span class="token operator">+=</span> ele<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>
        pos<span class="token punctuation">.</span>top <span class="token operator">+=</span> ele<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>

				<span class="token comment">// ele指向该元素的定位元素或者最近的 table,td,th,body元素</span>
				<span class="token operator">**</span><span class="token comment">//** 其中body元素的offsetParent属性为null</span>
        ele <span class="token operator">=</span> ele<span class="token punctuation">.</span>offsetParent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pos<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>补充知识：</p> <p>1、<code>HTMLElement.offsetLeft</code>  是一个<strong>只读</strong>属性，返回当前元素<strong>左上角</strong>相对于  <code>HTMLElement.offsetParent</code>  节点的左边界偏移的像素值。</p> <p>2、<code>HTMLElement.offsetTop</code> ****同理。</p> <p>3、对块级元素来说，<code>offsetTop</code>、<code>offsetLeft</code>、<code>offsetWidth</code>  及  <code>offsetHeight</code>  描述了元素相对于  <code>offsetParent</code>  的边界框。</p> <p>4、然而，对于可被截断到下一行的行内元素（如  <strong>span</strong>），<code>offsetTop</code>  和  <code>offsetLeft</code>  描述的是<em>第一个</em>边界框的位置（使用  <code>Element.getClientRects()</code>  来获取其宽度和高度），而  <code>offsetWidth</code>  和  <code>offsetHeight</code>  描述的是边界框的尺寸（使用  <code>Element.getBoundingClientRect</code>  来获取其位置）。因此，使用  <code>offsetLeft、offsetTop、offsetWidth</code>、<code>offsetHeight</code>  来对应 left、top、width 和 height 的一个盒子将不会是文本容器 span 的盒子边界。</p> <p>5、<code>HTMLElement.offsetParent</code> 是一个<strong>只读</strong>属性，返回一个指向最近的（指包含层级上的最近）包含该元素的定位元素或者最近的  <code>table,td,th,body</code>元素。当元素的  <code>style.display</code>  设置为 &quot;none&quot; 时，<code>offsetParent</code>  返回  <code>null</code>。</p> <h3 id="scrollto"><a href="#scrollto" class="header-anchor">#</a> scrollTo</h3> <p><strong>在 ${duration}时间内，滚动条平滑滚动到 ${to}指定位置。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">var</span> getScrollTop <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./getScrollTop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> setScrollTop <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./setScrollTop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用该API来逐帧滚动，达到平滑的效果</span>
<span class="token comment">// 做了兼容性处理，如果浏览器不支持则退化为宏任务定时器触发</span>
<span class="token keyword">var</span> requestAnimFrame <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    window<span class="token punctuation">.</span>requestAnimationFrame <span class="token operator">||</span>
    window<span class="token punctuation">.</span>webkitRequestAnimationFrame <span class="token operator">||</span>
    window<span class="token punctuation">.</span>mozRequestAnimationFrame <span class="token operator">||</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 *
 * @description  在 ${duration}时间内，滚动条平滑滚动到 ${to}指定位置
 * @param {Number} to
 * @param {Number} duration
 */</span>
<span class="token keyword">function</span> <span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> duration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果时间小于0，则直接滚动到指定位置</span>
  <span class="token comment">// 亦是递归终止条件</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>duration <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setScrollTop</span><span class="token punctuation">(</span>to<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 计算指定位置和当前位置的差值，可能为负数</span>
  <span class="token keyword">var</span> diff <span class="token operator">=</span> to <span class="token operator">-</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果指定位置就是当前位置，则返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>diff <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token comment">// 指定滚动的步长</span>
  <span class="token keyword">var</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>diff <span class="token operator">/</span> duration<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token function">requestAnimFrame</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果步长绝对值大于差值绝对值，那么则直接滚动差值的距离，并返回</span>
    <span class="token comment">// 这里使用绝对值是因为差值可能为负数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span> <span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setScrollTop</span><span class="token punctuation">(</span><span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> diff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 根据步长逐帧滚动</span>
    <span class="token function">setScrollTop</span><span class="token punctuation">(</span><span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> step<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 判断临界值条件，达到以下条件则意味着已经滚动到指定位置</span>
    <span class="token comment">// 如果超过指定位置也就是getScrollTop()大于或者小于to时，会在下一帧走到上面return的条件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      <span class="token punctuation">(</span>diff <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> to<span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span>diff <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">getScrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> to<span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 递归调用，时间减去16ms是因为一帧为1000 / 60 等于 16.67ms</span>
    <span class="token function">scrollTo</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> duration <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><h3 id="windowresize"><a href="#windowresize" class="header-anchor">#</a> windowResize</h3> <p><strong>H5 软键盘缩回、弹起回调。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description H5软键盘缩回、弹起回调
 * 当软件键盘弹起会改变当前 window.innerHeight，监听这个值变化
 * @param {Function} downCb 当软键盘弹起后，缩回的回调
 * @param {Function} upCb 当软键盘弹起的回调
 */</span>

<span class="token keyword">function</span> <span class="token function">windowResize</span><span class="token punctuation">(</span><span class="token parameter">downCb<span class="token punctuation">,</span> upCb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> clientHeight <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>

  <span class="token comment">// 兼容处理参数，防止传入非函数</span>
  downCb <span class="token operator">=</span> <span class="token keyword">typeof</span> downCb <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function-variable function">downCb</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  upCb <span class="token operator">=</span> <span class="token keyword">typeof</span> upCb <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function-variable function">upCb</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 监听resize事件</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resize&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> height <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>

    <span class="token comment">// resize事件触发后，如果两次innerHeight相等，则意味着软键盘将要收缩</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">===</span> clientHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">downCb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// innerHeight变小意味着软键盘将要弹起</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>height <span class="token operator">&lt;</span> clientHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">upCb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="throttle"><a href="#throttle" class="header-anchor">#</a> throttle</h3> <p><strong>函数节流。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description  函数节流。
 * 适用于限制`resize`和`scroll`等函数的调用频率
 *
 * @param  {Number}    delay          0 或者更大的毫秒数。 对于事件回调，大约100或250毫秒（或更高）的延迟是最有用的。
 * @param  {Boolean}   noTrailing     可选，默认为false。
 *                                    如果noTrailing为true，当节流函数被调用，每过`delay`毫秒`callback`也将执行一次。
 *                                    如果noTrailing为false或者未传入，`callback`将在最后一次调用节流函数后再执行一次.
 *                                    （延迟`delay`毫秒之后，节流函数没有被调用,内部计数器会复位）
 * @param  {Function}  callback       延迟毫秒后执行的函数。`this`上下文和所有参数都是按原样传递的，
 *                                    执行去节流功能时，调用`callback`。
 * @param  {Boolean}   debounceMode   如果`debounceMode`为true，`clear`在`delay`ms后执行。
 *                                    如果debounceMode是false，`callback`在`delay` ms之后执行。
 *
 * @return {Function}  新的节流函数
 */</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">delay<span class="token punctuation">,</span> noTrailing<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> debounceMode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// After wrapper has stopped being called, this timeout ensures that</span>
  <span class="token comment">// `callback` is executed at the proper times in `throttle` and `end`</span>
  <span class="token comment">// debounce modes.</span>
  <span class="token keyword">var</span> timeoutID<span class="token punctuation">;</span>

  <span class="token comment">// Keep track of the last time `callback` was executed.</span>
  <span class="token keyword">var</span> lastExec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// `noTrailing` defaults to falsy.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> noTrailing <span class="token operator">!==</span> <span class="token string">&quot;boolean&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    debounceMode <span class="token operator">=</span> callback<span class="token punctuation">;</span>
    callback <span class="token operator">=</span> noTrailing<span class="token punctuation">;</span>
    noTrailing <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// The `wrapper` function encapsulates all of the throttling / debouncing</span>
  <span class="token comment">// functionality and when executed will limit the rate at which `callback`</span>
  <span class="token comment">// is executed.</span>
  <span class="token keyword">function</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> elapsed <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> lastExec<span class="token punctuation">;</span>
    <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>

    <span class="token comment">// Execute `callback` and update the `lastExec` timestamp.</span>
    <span class="token keyword">function</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      lastExec <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If `debounceMode` is true (at begin) this is used to clear the flag</span>
    <span class="token comment">// to allow future `callback` executions.</span>
    <span class="token keyword">function</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      timeoutID <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>debounceMode <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>timeoutID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Since `wrapper` is being called for the first time and</span>
      <span class="token comment">// `debounceMode` is true (at begin), execute `callback`.</span>
      <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Clear any existing timeout.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeoutID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>debounceMode <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">&amp;&amp;</span> elapsed <span class="token operator">&gt;</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// In throttle mode, if `delay` time has been exceeded, execute</span>
      <span class="token comment">// `callback`.</span>
      <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>noTrailing <span class="token operator">!==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// In trailing throttle mode, since `delay` time has not been</span>
      <span class="token comment">// exceeded, schedule `callback` to execute `delay` ms after most</span>
      <span class="token comment">// recent execution.</span>
      <span class="token comment">//</span>
      <span class="token comment">// If `debounceMode` is true (at begin), schedule `clear` to execute</span>
      <span class="token comment">// after `delay` ms.</span>
      <span class="token comment">//</span>
      <span class="token comment">// If `debounceMode` is false (at end), schedule `callback` to</span>
      <span class="token comment">// execute after `delay` ms.</span>
      timeoutID <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>
        debounceMode <span class="token operator">?</span> clear <span class="token operator">:</span> exec<span class="token punctuation">,</span>
        debounceMode <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> delay <span class="token operator">-</span> elapsed <span class="token operator">:</span> delay
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Return the wrapper function.</span>
  <span class="token keyword">return</span> wrapper<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br></div></div><h3 id="debounce"><a href="#debounce" class="header-anchor">#</a> debounce</h3> <p><strong>函数防抖。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">var</span> throttle <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./throttle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @description 函数防抖 
 * 与throttle不同的是，debounce保证一个函数在多少毫秒内不再被触发，只会执行一次，
 * 要么在第一次调用return的防抖函数时执行，要么在延迟指定毫秒后调用。
 * @example 适用场景：如在线编辑的自动存储防抖。
 * @param  {Number}   delay         0或者更大的毫秒数。 对于事件回调，大约100或250毫秒（或更高）的延迟是最有用的。
 * @param  {Boolean}  atBegin       可选，默认为false。
 *                                  如果`atBegin`为false或未传入，回调函数则在第一次调用return的防抖函数后延迟指定毫秒调用。
                                    如果`atBegin`为true，回调函数则在第一次调用return的防抖函数时直接执行
 * @param  {Function} callback      延迟毫秒后执行的函数。`this`上下文和所有参数都是按原样传递的，
 *                                  执行去抖动功能时，，调用`callback`。
 *
 * @return {Function} 新的防抖函数。
 */</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">delay<span class="token punctuation">,</span> atBegin<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> callback <span class="token operator">===</span> <span class="token keyword">undefined</span>
    <span class="token operator">?</span> <span class="token function">throttle</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> atBegin<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">throttle</span><span class="token punctuation">(</span>delay<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> atBegin <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="getkeyname"><a href="#getkeyname" class="header-anchor">#</a> getKeyName</h3> <p><strong>根据<code>keycode</code>获得键名。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">var</span> keyCodeMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">8</span><span class="token operator">:</span> <span class="token string">&quot;Backspace&quot;</span><span class="token punctuation">,</span>
  <span class="token number">9</span><span class="token operator">:</span> <span class="token string">&quot;Tab&quot;</span><span class="token punctuation">,</span>
  <span class="token number">13</span><span class="token operator">:</span> <span class="token string">&quot;Enter&quot;</span><span class="token punctuation">,</span>
  <span class="token number">16</span><span class="token operator">:</span> <span class="token string">&quot;Shift&quot;</span><span class="token punctuation">,</span>
  <span class="token number">17</span><span class="token operator">:</span> <span class="token string">&quot;Ctrl&quot;</span><span class="token punctuation">,</span>
  <span class="token number">18</span><span class="token operator">:</span> <span class="token string">&quot;Alt&quot;</span><span class="token punctuation">,</span>
  <span class="token number">19</span><span class="token operator">:</span> <span class="token string">&quot;Pause&quot;</span><span class="token punctuation">,</span>
  <span class="token number">20</span><span class="token operator">:</span> <span class="token string">&quot;Caps Lock&quot;</span><span class="token punctuation">,</span>
  <span class="token number">27</span><span class="token operator">:</span> <span class="token string">&quot;Escape&quot;</span><span class="token punctuation">,</span>
  <span class="token number">32</span><span class="token operator">:</span> <span class="token string">&quot;Space&quot;</span><span class="token punctuation">,</span>
  <span class="token number">33</span><span class="token operator">:</span> <span class="token string">&quot;Page Up&quot;</span><span class="token punctuation">,</span>
  <span class="token number">34</span><span class="token operator">:</span> <span class="token string">&quot;Page Down&quot;</span><span class="token punctuation">,</span>
  <span class="token number">35</span><span class="token operator">:</span> <span class="token string">&quot;End&quot;</span><span class="token punctuation">,</span>
  <span class="token number">36</span><span class="token operator">:</span> <span class="token string">&quot;Home&quot;</span><span class="token punctuation">,</span>
  <span class="token number">37</span><span class="token operator">:</span> <span class="token string">&quot;Left&quot;</span><span class="token punctuation">,</span>
  <span class="token number">38</span><span class="token operator">:</span> <span class="token string">&quot;Up&quot;</span><span class="token punctuation">,</span>
  <span class="token number">39</span><span class="token operator">:</span> <span class="token string">&quot;Right&quot;</span><span class="token punctuation">,</span>
  <span class="token number">40</span><span class="token operator">:</span> <span class="token string">&quot;Down&quot;</span><span class="token punctuation">,</span>
  <span class="token number">42</span><span class="token operator">:</span> <span class="token string">&quot;Print Screen&quot;</span><span class="token punctuation">,</span>
  <span class="token number">45</span><span class="token operator">:</span> <span class="token string">&quot;Insert&quot;</span><span class="token punctuation">,</span>
  <span class="token number">46</span><span class="token operator">:</span> <span class="token string">&quot;Delete&quot;</span><span class="token punctuation">,</span>

  <span class="token number">48</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
  <span class="token number">49</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
  <span class="token number">50</span><span class="token operator">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
  <span class="token number">51</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
  <span class="token number">52</span><span class="token operator">:</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span>
  <span class="token number">53</span><span class="token operator">:</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span>
  <span class="token number">54</span><span class="token operator">:</span> <span class="token string">&quot;6&quot;</span><span class="token punctuation">,</span>
  <span class="token number">55</span><span class="token operator">:</span> <span class="token string">&quot;7&quot;</span><span class="token punctuation">,</span>
  <span class="token number">56</span><span class="token operator">:</span> <span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span>
  <span class="token number">57</span><span class="token operator">:</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>

  <span class="token number">65</span><span class="token operator">:</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span>
  <span class="token number">66</span><span class="token operator">:</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span>
  <span class="token number">67</span><span class="token operator">:</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span>
  <span class="token number">68</span><span class="token operator">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">,</span>
  <span class="token number">69</span><span class="token operator">:</span> <span class="token string">&quot;E&quot;</span><span class="token punctuation">,</span>
  <span class="token number">70</span><span class="token operator">:</span> <span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span>
  <span class="token number">71</span><span class="token operator">:</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">,</span>
  <span class="token number">72</span><span class="token operator">:</span> <span class="token string">&quot;H&quot;</span><span class="token punctuation">,</span>
  <span class="token number">73</span><span class="token operator">:</span> <span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span>
  <span class="token number">74</span><span class="token operator">:</span> <span class="token string">&quot;J&quot;</span><span class="token punctuation">,</span>
  <span class="token number">75</span><span class="token operator">:</span> <span class="token string">&quot;K&quot;</span><span class="token punctuation">,</span>
  <span class="token number">76</span><span class="token operator">:</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span>
  <span class="token number">77</span><span class="token operator">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
  <span class="token number">78</span><span class="token operator">:</span> <span class="token string">&quot;N&quot;</span><span class="token punctuation">,</span>
  <span class="token number">79</span><span class="token operator">:</span> <span class="token string">&quot;O&quot;</span><span class="token punctuation">,</span>
  <span class="token number">80</span><span class="token operator">:</span> <span class="token string">&quot;P&quot;</span><span class="token punctuation">,</span>
  <span class="token number">81</span><span class="token operator">:</span> <span class="token string">&quot;Q&quot;</span><span class="token punctuation">,</span>
  <span class="token number">82</span><span class="token operator">:</span> <span class="token string">&quot;R&quot;</span><span class="token punctuation">,</span>
  <span class="token number">83</span><span class="token operator">:</span> <span class="token string">&quot;S&quot;</span><span class="token punctuation">,</span>
  <span class="token number">84</span><span class="token operator">:</span> <span class="token string">&quot;T&quot;</span><span class="token punctuation">,</span>
  <span class="token number">85</span><span class="token operator">:</span> <span class="token string">&quot;U&quot;</span><span class="token punctuation">,</span>
  <span class="token number">86</span><span class="token operator">:</span> <span class="token string">&quot;V&quot;</span><span class="token punctuation">,</span>
  <span class="token number">87</span><span class="token operator">:</span> <span class="token string">&quot;W&quot;</span><span class="token punctuation">,</span>
  <span class="token number">88</span><span class="token operator">:</span> <span class="token string">&quot;X&quot;</span><span class="token punctuation">,</span>
  <span class="token number">89</span><span class="token operator">:</span> <span class="token string">&quot;Y&quot;</span><span class="token punctuation">,</span>
  <span class="token number">90</span><span class="token operator">:</span> <span class="token string">&quot;Z&quot;</span><span class="token punctuation">,</span>

  <span class="token number">91</span><span class="token operator">:</span> <span class="token string">&quot;Windows&quot;</span><span class="token punctuation">,</span>
  <span class="token number">93</span><span class="token operator">:</span> <span class="token string">&quot;Right Click&quot;</span><span class="token punctuation">,</span>

  <span class="token number">96</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 0&quot;</span><span class="token punctuation">,</span>
  <span class="token number">97</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 1&quot;</span><span class="token punctuation">,</span>
  <span class="token number">98</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 2&quot;</span><span class="token punctuation">,</span>
  <span class="token number">99</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 3&quot;</span><span class="token punctuation">,</span>
  <span class="token number">100</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 4&quot;</span><span class="token punctuation">,</span>
  <span class="token number">101</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 5&quot;</span><span class="token punctuation">,</span>
  <span class="token number">102</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 6&quot;</span><span class="token punctuation">,</span>
  <span class="token number">103</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 7&quot;</span><span class="token punctuation">,</span>
  <span class="token number">104</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 8&quot;</span><span class="token punctuation">,</span>
  <span class="token number">105</span><span class="token operator">:</span> <span class="token string">&quot;Numpad 9&quot;</span><span class="token punctuation">,</span>
  <span class="token number">106</span><span class="token operator">:</span> <span class="token string">&quot;Numpad *&quot;</span><span class="token punctuation">,</span>
  <span class="token number">107</span><span class="token operator">:</span> <span class="token string">&quot;Numpad +&quot;</span><span class="token punctuation">,</span>
  <span class="token number">109</span><span class="token operator">:</span> <span class="token string">&quot;Numpad -&quot;</span><span class="token punctuation">,</span>
  <span class="token number">110</span><span class="token operator">:</span> <span class="token string">&quot;Numpad .&quot;</span><span class="token punctuation">,</span>
  <span class="token number">111</span><span class="token operator">:</span> <span class="token string">&quot;Numpad /&quot;</span><span class="token punctuation">,</span>

  <span class="token number">112</span><span class="token operator">:</span> <span class="token string">&quot;F1&quot;</span><span class="token punctuation">,</span>
  <span class="token number">113</span><span class="token operator">:</span> <span class="token string">&quot;F2&quot;</span><span class="token punctuation">,</span>
  <span class="token number">114</span><span class="token operator">:</span> <span class="token string">&quot;F3&quot;</span><span class="token punctuation">,</span>
  <span class="token number">115</span><span class="token operator">:</span> <span class="token string">&quot;F4&quot;</span><span class="token punctuation">,</span>
  <span class="token number">116</span><span class="token operator">:</span> <span class="token string">&quot;F5&quot;</span><span class="token punctuation">,</span>
  <span class="token number">117</span><span class="token operator">:</span> <span class="token string">&quot;F6&quot;</span><span class="token punctuation">,</span>
  <span class="token number">118</span><span class="token operator">:</span> <span class="token string">&quot;F7&quot;</span><span class="token punctuation">,</span>
  <span class="token number">119</span><span class="token operator">:</span> <span class="token string">&quot;F8&quot;</span><span class="token punctuation">,</span>
  <span class="token number">120</span><span class="token operator">:</span> <span class="token string">&quot;F9&quot;</span><span class="token punctuation">,</span>
  <span class="token number">121</span><span class="token operator">:</span> <span class="token string">&quot;F10&quot;</span><span class="token punctuation">,</span>
  <span class="token number">122</span><span class="token operator">:</span> <span class="token string">&quot;F11&quot;</span><span class="token punctuation">,</span>
  <span class="token number">123</span><span class="token operator">:</span> <span class="token string">&quot;F12&quot;</span><span class="token punctuation">,</span>

  <span class="token number">144</span><span class="token operator">:</span> <span class="token string">&quot;Num Lock&quot;</span><span class="token punctuation">,</span>
  <span class="token number">145</span><span class="token operator">:</span> <span class="token string">&quot;Scroll Lock&quot;</span><span class="token punctuation">,</span>
  <span class="token number">182</span><span class="token operator">:</span> <span class="token string">&quot;My Computer&quot;</span><span class="token punctuation">,</span>
  <span class="token number">183</span><span class="token operator">:</span> <span class="token string">&quot;My Calculator&quot;</span><span class="token punctuation">,</span>
  <span class="token number">186</span><span class="token operator">:</span> <span class="token string">&quot;;&quot;</span><span class="token punctuation">,</span>
  <span class="token number">187</span><span class="token operator">:</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span>
  <span class="token number">188</span><span class="token operator">:</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>
  <span class="token number">189</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span>
  <span class="token number">190</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span>
  <span class="token number">191</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
  <span class="token number">192</span><span class="token operator">:</span> <span class="token string">&quot;`&quot;</span><span class="token punctuation">,</span>
  <span class="token number">219</span><span class="token operator">:</span> <span class="token string">&quot;[&quot;</span><span class="token punctuation">,</span>
  <span class="token number">220</span><span class="token operator">:</span> <span class="token string">&quot;\\&quot;</span><span class="token punctuation">,</span>
  <span class="token number">221</span><span class="token operator">:</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">,</span>
  <span class="token number">222</span><span class="token operator">:</span> <span class="token string">&quot;'&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * @description 根据keycode获得键名
 * @param  {Number} keycode
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">getKeyName</span><span class="token punctuation">(</span><span class="token parameter">keycode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果keycode存在于维护的散列表里，则返回对应的值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCodeMap<span class="token punctuation">[</span>keycode<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> keyCodeMap<span class="token punctuation">[</span>keycode<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 否则打印错误，并返回空字符串</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Unknow Key(Key Code:&quot;</span> <span class="token operator">+</span> keycode <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br></div></div><h3 id="deepclone"><a href="#deepclone" class="header-anchor">#</a> deepClone</h3> <p><strong>深拷贝。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description 深拷贝，支持常见类型
 * @param {Any} values
 * @return {Any}
 */</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> copy<span class="token punctuation">;</span>

  <span class="token comment">// 处理null、undefined以及原始类型的情况，直接返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> values <span class="token operator">||</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">!=</span> <span class="token keyword">typeof</span> values<span class="token punctuation">)</span> <span class="token keyword">return</span> values<span class="token punctuation">;</span>

  <span class="token comment">// 处理Date，先获取时间，再设置时间并返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    copy<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 处理数组，循环每一项，同时递归调用深拷贝函数并赋值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      copy<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 处理对象，循环每一项，如果是自有属性就递归调用深拷贝函数并赋值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    copy <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> attr <span class="token keyword">in</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>values<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span> copy<span class="token punctuation">[</span>attr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> copy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 异常处理</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unable to copy values! Its type isn't supported.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="isemptyobject"><a href="#isemptyobject" class="header-anchor">#</a> isEmptyObject</h3> <p><strong>判断<code>obj</code>是否为空。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   判断`obj`是否为空
 * @param  {Object} obj
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果值为falsy、类型不为`object`、是数组则返回false</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果对象没有自身可枚举的键，则返回true，否则返回false</span>
  <span class="token keyword">return</span> <span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>补充知识：</p> <ol><li><strong><code>Object.keys()</code></strong>  方法会返回一个由一个给定对象的<strong>自身可枚举</strong>属性组成的数组，数组中属性名的排列顺序和正常循环遍历该对象时返回的顺序一致 。</li> <li><strong><code>Object.getOwnPropertyNames()</code><strong>方法返回一个由指定对象的</strong>所有自身属性</strong>的属性名（包括不可枚举属性但不包括 Symbol 值作为名称的属性）组成的数组。</li></ol> <h3 id="randomcolor"><a href="#randomcolor" class="header-anchor">#</a> randomColor</h3> <p><strong>随机生成颜色。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 随机生成颜色
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">randomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;#&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">&quot;00000&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0x1000000</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>补充知识：</p> <ol><li><p>根据运算符优先级，乘(<code>*</code>)的优先级大于按位左移(<code>&lt;&lt;</code>)，由于生成的随机颜色是 16 进制的 6 位数，因此将 16 进制的 7 位数与伪随机相乘，生成的 16 进制刚好是 6 位。</p></li> <li><p>生成随机数后进行按位左移 0 位，目的是进行取整。<strong>左移操作符  (<code>&lt;&lt;</code>)</strong>  将第一个操作数向左移动指定位数，左边超出的位数将会被清除，右边将会补零。通过位运算进行取整的方式有如下几种：</p> <p>方式 1：与 0 进行或运算 <code>x|0</code></p> <p>方式 2：与-1 进行与运算<code>x&amp;-1</code></p> <p>方式 3：与 0 异或 <code>x^0</code></p> <p>方式 4：双非运算 <code>~~x</code></p> <p>方式 5：与同一个数两次异或 <code>x^a^a</code></p> <p>方式 6：左移 0 位 <code>x&lt;&lt;0</code></p> <p>方式 7：有符号右移 0 位 <code>x&gt;&gt;0</code></p> <p>方式 8：对正数无符号右移 0 位 <code>x&gt;&gt;&gt;0</code></p> <p>方式 9：无符号右移 0 位再与 0 进行或运算 <code>x&gt;&gt;&gt;0|0</code></p> <p>方式 10：无符号右移 0 位再与 0 进行异或运算 <code>x&gt;&gt;&gt;0^0</code></p></li> <li><p><strong><code>Math.random()</code></strong>  函数返回一个浮点数,  伪随机数在范围从<strong>0</strong>到小于<strong>1</strong>([0,1))。如果碰巧随机出 0，那么需要补齐 6 位。所以需要使用<code>’00000’</code>添加前缀。这里还设计到隐式转换，最终转换为了字符串。</p></li> <li><p><code>Number.prototype.toString()</code>方法返回指定  <code>Number</code>  对象的字符串表示形式。其中接收一个参数，参数表示指定要用于数字到字符串的转换的基数(从 2 到 36)。如果未指定参数，则<strong>默认值为 10</strong>。由于使用伪随机与<code>0x1000000</code> 相乘并取整返回的是 10 进制，因此需要通过<code>toString(16)</code> 转换为 16 进制。</p></li> <li><p><code>String.prototype.slice()</code>方法提取某个字符串的一部分，并<strong>返回一个新的字符串</strong>，且<strong>不会改动原字符串</strong>。该方法接收两个参数。</p> <ol><li><strong>beginIndex。</strong> 从该索引（以 0 为基数）处开始提取原字符串中的字符。如果值为负数，会被当做  <code>strLength + beginIndex</code>  看待。其中<code>strLength</code> 为字符串长度。</li> <li><strong>endIndex。</strong> 该参数可选。在该索引（以 0 为基数）处结束提取字符串。如果省略该参数，<code>slice()</code>  会一直提取到字符串末尾。如果该参数为负数，则被看作是 <code>strLength + endIndex</code>。</li></ol></li> <li><p>回到上述源码，整体来看最终结果会有两种：</p> <ol><li>当<code>Math.random()</code> 为 0 时，<code>('00000' + (Math.random() * 0x1000000 &lt;&lt; 0).toString(16))</code> 返回 <code>'000000'</code> 。通过<code>slice(-6)</code> ，按照截取规则，相当于<code>slice(6 + (-6))</code>，也就是<code>slice(0)</code>，那么最终就是截取整个字符串。</li> <li>当<code>Math.random()</code> 不为 0 时，<code>('00000' + (Math.random() * 0x1000000 &lt;&lt; 0).toString(16))</code> 返回 <code>'00000bd4f6c'</code> (随机) 。按照截取规则，相当于<code>slice(11 + (-6))</code> ，也就是<code>slice(5)</code> ，最终截取就是从第 5 个索引开始截取，直到最后( <code>'bd4f6c'</code>)。</li> <li>最后一步拼接<code>#</code>，并返回。</li></ol></li></ol> <h3 id="randomnum"><a href="#randomnum" class="header-anchor">#</a> randomNum</h3> <p><strong>生成指定范围<code>[min, max]</code>的随机数。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 生成指定范围[min, max]的随机数
 * @param  {Number} min
 * @param  {Number} max
 * @return {Number}
 */</span>
<span class="token keyword">function</span> <span class="token function">randomNum</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 向上取整最小范围</span>
  min <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>min<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 向下取整最大范围</span>
  max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 由于伪随机数无法取1，因此需要再加一进行随机，方可随机到max</span>
  <span class="token comment">// 向下取整最大值，并与最小值相加就是最后的随机值</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="iscolor"><a href="#iscolor" class="header-anchor">#</a> isColor</h3> <p><strong>判断是否为 16 进制颜色。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 判断是否为16进制颜色，rgb 或 rgba
 * @param  {String}  str
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isColor</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 匹配形如 #fff、#fffffff、rgb(255,255,255)、rgba(255,255,255,1.0)</span>
  <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span>#<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>a<span class="token operator">-</span>fA<span class="token operator">-</span><span class="token constant">F</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">|</span><span class="token punctuation">[</span>rR<span class="token punctuation">]</span><span class="token punctuation">[</span>gG<span class="token punctuation">]</span><span class="token punctuation">[</span>Bb<span class="token punctuation">]</span><span class="token punctuation">(</span>\<span class="token punctuation">(</span><span class="token punctuation">(</span>\s<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>\d<span class="token operator">|</span><span class="token number">25</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">?</span>\d<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token string">&quot;0-9a-fA-F]{3}){1,2}|[rR][gG][Bb&quot;</span><span class="token punctuation">)</span>\s<span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span>\s<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>\d<span class="token operator">|</span><span class="token number">25</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">?</span>\d<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\s<span class="token operator">*</span>\<span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">[</span>Aa<span class="token punctuation">]</span>\<span class="token punctuation">(</span><span class="token punctuation">(</span>\s<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>\d<span class="token operator">|</span><span class="token number">25</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">?</span>\d<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>\s<span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>\s<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">01</span><span class="token punctuation">]</span><span class="token operator">|</span><span class="token number">0</span>\<span class="token punctuation">.</span>\d<span class="token operator">+</span><span class="token punctuation">)</span>\s<span class="token operator">*</span>\<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>
    str
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div align="center"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f59bf5a363554765bb216d072fbc2c01~tplv-k3u1fbpfcp-watermark.image" width="100%"></div> <p>通过上图可以精确的看到正则匹配的流程。不过看上去组 5 和组 6 是重复的，不知道是刻意为之还是？</p> <h3 id="isemail"><a href="#isemail" class="header-anchor">#</a> isEmail</h3> <p><strong>判断是否为邮箱地址。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   判断是否为邮箱地址
 * @param  {String}  str
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断是否为email最核心的是@和.</span>
  <span class="token keyword">return</span> <span class="token operator">/</span>\w<span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">+</span><span class="token punctuation">.</span><span class="token punctuation">]</span>\w<span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">*</span>@\w<span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">]</span>\w<span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">*</span>\<span class="token punctuation">.</span>\w<span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">]</span>\w<span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div align="center"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8d633459db0843148b8753d72ff1baa8~tplv-k3u1fbpfcp-watermark.image" width="100%"></div> <p>从上图也可以看出，<code>@</code>和<code>.</code>都是必需的。</p> <h3 id="isidcard"><a href="#isidcard" class="header-anchor">#</a> isIdCard</h3> <p><strong>判断是否为身份证号。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description  判断是否为身份证号
 * @param  {String|Number} str
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isIdCard</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>\d<span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span>\d<span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">|</span><span class="token number">1</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">]</span>\d<span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\d<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span>$<span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>\d<span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span>\d<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span>\d<span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">|</span><span class="token number">1</span><span class="token operator">|</span><span class="token number">2</span><span class="token punctuation">]</span>\d<span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">3</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>\d<span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">|</span>\d<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">[</span>Xx<span class="token punctuation">]</span><span class="token punctuation">)</span>$<span class="token punctuation">)</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>
    str
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div align="center"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/59e6acd110e14f16ae4a2c4923c19e41~tplv-k3u1fbpfcp-watermark.image" width="100%"></div> <p>该方法没有很好的判断年份以及省市区编号。如果想要更加精确，需要根据身份证的组成单独进行判断，比如前 6 位是省市区的编号等等。</p> <h3 id="isphonenum"><a href="#isphonenum" class="header-anchor">#</a> isPhoneNum</h3> <p><strong>判断是否为手机号。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   判断是否为手机号
 * @param  {String|Number} str
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isPhoneNum</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span>\<span class="token operator">+</span><span class="token operator">?</span><span class="token number">0</span><span class="token operator">?</span><span class="token number">86</span>\<span class="token operator">-</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token number">1</span><span class="token punctuation">[</span><span class="token number">3456789</span><span class="token punctuation">]</span>\d<span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">}</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div align="center"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a57f92d143bf420e878686efba49d9c9~tplv-k3u1fbpfcp-watermark.image" width="100%"></div> <p>从上图可以看出，该正则考虑到了<code>+86</code> 国家编号的情况。然后手机号的第二位包括了<code>[3456789]</code> 。</p> <h3 id="isurl"><a href="#isurl" class="header-anchor">#</a> isUrl</h3> <p><strong>判断是否为 URL 地址。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   判断是否为URL地址
 * @param  {String} str
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isUrl</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">/</span><span class="token punctuation">[</span><span class="token operator">-</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z0</span><span class="token operator">-</span><span class="token number">9</span>@<span class="token operator">:</span><span class="token operator">%</span><span class="token punctuation">.</span>_\<span class="token operator">+</span><span class="token operator">~</span>#<span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">256</span><span class="token punctuation">}</span>\<span class="token punctuation">.</span><span class="token punctuation">[</span>a<span class="token operator">-</span>z<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">}</span>\<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span>a<span class="token operator">-</span>zA<span class="token operator">-</span><span class="token constant">Z0</span><span class="token operator">-</span><span class="token number">9</span>@<span class="token operator">:</span><span class="token operator">%</span>_\<span class="token operator">+</span><span class="token punctuation">.</span><span class="token operator">~</span>#<span class="token operator">?</span><span class="token operator">&amp;</span><span class="token comment">//=]*)/i.test(</span>
    str
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div align="center"><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2051aee00cda41c4a339df8f75214b22~tplv-k3u1fbpfcp-watermark.image" width="100%"></div> <h3 id="digituppercase"><a href="#digituppercase" class="header-anchor">#</a> <strong>digitUppercase</strong></h3> <p><strong>现金额转大写。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   现金额转大写
 * @param  {Number} n
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">digitUppercase</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> fraction <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;角&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;分&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> digit <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;零&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;壹&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;贰&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;叁&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;肆&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;伍&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;陆&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;柒&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;捌&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;玖&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> unit <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;元&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;万&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;亿&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;拾&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;佰&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;仟&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// n为负数则是欠</span>
  <span class="token keyword">var</span> head <span class="token operator">=</span> n <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">&quot;欠&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 处理了n为负数的情况，此处直接取绝对值</span>
  n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 处理小数点的情况</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fraction<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s <span class="token operator">+=</span> <span class="token punctuation">(</span>
      digit<span class="token punctuation">[</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> fraction<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/零./</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 如果处理完小数点依旧为空，则意味着是整数</span>
  s <span class="token operator">=</span> s <span class="token operator">||</span> <span class="token string">&quot;整&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 对值进行向下取整</span>
  n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 从低位到高位进行拼接，并且去除多余的零</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> unit<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> unit<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      p <span class="token operator">=</span> digit<span class="token punctuation">[</span>n <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> unit<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> p<span class="token punctuation">;</span>
      n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    s <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(零.)*零 $/</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^$/</span><span class="token punctuation">,</span> <span class="token string">&quot;零&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> unit<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 进行整体的拼接，并调整描述</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    head <span class="token operator">+</span>
    s
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(零.)*零元/</span><span class="token punctuation">,</span> <span class="token string">&quot;元&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(零.)+/g</span><span class="token punctuation">,</span> <span class="token string">&quot;零&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^整 $/</span><span class="token punctuation">,</span> <span class="token string">&quot;零元整&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h3 id="issupportwebp"><a href="#issupportwebp" class="header-anchor">#</a> isSupportWebP</h3> <p><strong>判断浏览器是否支持 webP 格式图片。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 判断浏览器是否支持webP格式图片
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isSupportWebP</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// array.map方法是ES5支持的方法，如果浏览器不支持该方法，则不可能支持webP</span>
  <span class="token comment">// 创建canvas并设置包含图片展示的data url，如果支持webP，则返回的字符串开头便是data:image/webp</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map <span class="token operator">&amp;&amp;</span>
    document
      <span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&quot;image/webp&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;data:image/webp&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>补充知识：</p> <ol><li><strong><code>HTMLCanvasElement.toDataURL()</code></strong>  方法返回一个包含图片展示的  <code>data URI</code> 。可以使用<code>type</code>参数(可选)指定类型，默认为<code>image/png</code>。第二个可选参数是图片质量，取值范围是<code>0-1</code>，不传或者超出取值范围，则取默认值  <code>0.92</code>。图片的分辨率为<code>96dpi</code>。返回值是包含  <code>data URI</code>的<code>DOMString</code>。</li></ol> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code>  document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/webp'</span><span class="token punctuation">)</span>

  <span class="token comment">//以下为输出结果</span>
  data<span class="token operator">:</span>image<span class="token operator">/</span>webp<span class="token punctuation">;</span>base64<span class="token punctuation">,</span>UklGRtgCAABXRUJQVlA4WAoAAAAwAAAAKwEAlQAASUNDUBgCAAAAAAIYAAAAAAQwAABtbnRyUkdCIFhZWiAAAAAAAAAAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAAHRyWFlaAAABZAAAABRnWFlaAAABeAAAABRiWFlaAAABjAAAABRyVFJDAAABoAAAAChnVFJDAAABoAAAAChiVFJDAAABoAAAACh3dHB0AAAByAAAABRjcHJ0AAAB3AAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAFgAAAAcAHMAUgBHAEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA<span class="token operator">+</span>EAAC2z3BhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABYWVogAAAAAAAA9tYAAQAAAADTLW1sdWMAAAAAAAAAAQAAAAxlblVTAAAAIAAAABwARwBvAG8AZwBsAGUAIABJAG4AYwAuACAAMgAwADEANkFMUEgSAAAAAQcQEREQkCT<span class="token operator">+</span><span class="token operator">/</span>x9F9D<span class="token operator">/</span>tf0MAVlA4IIAAAABwDQCdASosAZYAPm02mUmkIyKhICgAgA2JaW7hdrEbQAnsA99snIe<span class="token operator">+</span><span class="token number">2</span>TkPfbJyHvtk5D32ych77ZOQ99snIe<span class="token operator">+</span><span class="token number">2</span>TkPfbJyHvtk5D32ych77ZOQ99snIe<span class="token operator">+</span><span class="token number">2</span>TkPfbJyHvtk5D32ych77ZOQ99snIe<span class="token operator">+</span><span class="token number">2</span>TkPfasAAD<span class="token operator">+</span><span class="token operator">/</span><span class="token number">9</span>YAAAAAAAAAAA<span class="token operator">==</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>如果浏览器支持<code>webP</code> ，那么<code>data URI</code> 则会以<code>data:image/webp</code>开头。通过字符串的原型方法<code>indexOf('data:image/webp') == 0</code> 就可以判断是否支持。</li> <li><code>Data URLs</code> 即前缀为  <code>data:</code>  协议的 URL，其允许内容创建者向<strong>文档中嵌入小文件</strong>。<code>Data URLs</code> 由四个部分组成：前缀(<code>data:</code>)、指示数据类型的<code>MIME</code>类型、如果非文本则为可选的<code>base64</code>标记、数据本身。如果<code>MIME</code>类型被省略，则默认值为  <code>text/plain;charset=US-ASCII</code> 。注意四个部分之间的分隔符，分别是<code>:</code>、<code>;</code>、<code>,</code> 。</li></ol> <h3 id="formatpasstime"><a href="#formatpasstime" class="header-anchor">#</a> <strong>formatPassTime</strong></h3> <p><strong>格式化指定时间距现在的已过时间。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description   格式化 ${startTime}距现在的已过时间
 * @param  {Date} startTime
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">formatPassTime</span><span class="token punctuation">(</span><span class="token parameter">startTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取当前时间，返回的是毫秒数</span>
  <span class="token keyword">var</span> currentTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 计算时间间隔</span>
    time <span class="token operator">=</span> currentTime <span class="token operator">-</span> startTime<span class="token punctuation">,</span>
    <span class="token comment">// 分别转换年、月、日、小时、分钟</span>
    day <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    hour <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    min <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    month <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>day <span class="token operator">/</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    year <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>month <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 按顺序判断年、月、日、小时、分钟，如果存在则拼接相应描述并返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>year<span class="token punctuation">)</span> <span class="token keyword">return</span> year <span class="token operator">+</span> <span class="token string">&quot;年前&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>month<span class="token punctuation">)</span> <span class="token keyword">return</span> month <span class="token operator">+</span> <span class="token string">&quot;个月前&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>day<span class="token punctuation">)</span> <span class="token keyword">return</span> day <span class="token operator">+</span> <span class="token string">&quot;天前&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hour<span class="token punctuation">)</span> <span class="token keyword">return</span> hour <span class="token operator">+</span> <span class="token string">&quot;小时前&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>min<span class="token punctuation">)</span> <span class="token keyword">return</span> min <span class="token operator">+</span> <span class="token string">&quot;分钟前&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">// 如果时间间隔小于分钟级别，则直接返回刚刚</span>
  <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token string">&quot;刚刚&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="formatremaintime"><a href="#formatremaintime" class="header-anchor">#</a> formatRemainTime</h3> <p><strong>格式化现在距离指定时间的剩余时间。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   格式化现在距 ${endTime}的剩余时间
 * @param  {Date} endTime
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">formatRemainTime</span><span class="token punctuation">(</span><span class="token parameter">endTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> startDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//开始时间</span>
  <span class="token keyword">var</span> endDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>endTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//结束时间</span>
  <span class="token keyword">var</span> t <span class="token operator">=</span> endDate<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startDate<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//时间差</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果时间间隔大于等于0，则进行转换，否则直接返回都是0的数据</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 计算天数并向下取整</span>
    d <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">3600</span> <span class="token operator">/</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 小时、分钟、秒分别通过取余和向下取整来拿到数据</span>
    h <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 返回拼接的剩余时间</span>
  <span class="token keyword">return</span> d <span class="token operator">+</span> <span class="token string">&quot;天 &quot;</span> <span class="token operator">+</span> h <span class="token operator">+</span> <span class="token string">&quot;小时 &quot;</span> <span class="token operator">+</span> m <span class="token operator">+</span> <span class="token string">&quot;分钟 &quot;</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">&quot;秒&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="isleapyear"><a href="#isleapyear" class="header-anchor">#</a> <strong>isLeapYear</strong></h3> <p><strong>判断是否为闰年。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description 是否为闰年
 * @param {Number} year
 * @returns {Boolean}
 */</span>

<span class="token keyword">function</span> <span class="token function">isLeapYear</span><span class="token punctuation">(</span><span class="token parameter">year</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 闰年的判断依据是年份为4的倍数，同时年份不是100的倍数或者是400的倍数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">===</span> year <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>year <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> year <span class="token operator">%</span> <span class="token number">400</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="issameday"><a href="#issameday" class="header-anchor">#</a> isSameDay</h3> <p><strong>判断是否为同一天。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description   判断是否为同一天
 * @param  {Date} date1
 * @param  {Date} date2 可选／默认值：当天
 * @return {Boolean}
 */</span>
<span class="token keyword">function</span> <span class="token function">isSameDay</span><span class="token punctuation">(</span><span class="token parameter">date1<span class="token punctuation">,</span> date2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>date2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    date2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 分别获取两个参数的年月日</span>
  <span class="token keyword">var</span> date1_year <span class="token operator">=</span> date1<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    date1_month <span class="token operator">=</span> date1<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    date1_date <span class="token operator">=</span> date1<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> date2_year <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    date2_month <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    date2_date <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 比较日月年是否相等，如果都相等，则为同一天</span>
  <span class="token comment">// 从后往前比较可以提前退出，防止无效判断</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    date1_date <span class="token operator">===</span> date2_date <span class="token operator">&amp;&amp;</span>
    date1_month <span class="token operator">===</span> date2_month <span class="token operator">&amp;&amp;</span>
    date1_year <span class="token operator">===</span> date2_year
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="timeleft"><a href="#timeleft" class="header-anchor">#</a> timeLeft</h3> <p><strong>计算开始时间到结束时间的剩余时间。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description ${startTime - endTime}的剩余时间,startTime大于endTime时，均返回0
 * @param { Date | String } startTime
 * @param { Date | String } endTime
 * @returns { Object } { d, h, m, s } 天 时 分 秒
 */</span>
<span class="token keyword">function</span> <span class="token function">timeLeft</span><span class="token punctuation">(</span><span class="token parameter">startTime<span class="token punctuation">,</span> endTime</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数缺失则直接返回</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>startTime <span class="token operator">||</span> <span class="token operator">!</span>endTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 如果参数是Date实例则直接使用，否则转换为Date实例</span>
  <span class="token comment">// 将时间格式的-转换为/，是为了适配ios</span>
  <span class="token keyword">var</span> startDate<span class="token punctuation">,</span> endDate<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>startTime <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    startDate <span class="token operator">=</span> startTime<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    startDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>startTime<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//开始时间</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>endTime <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    endDate <span class="token operator">=</span> endTime<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    endDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>endTime<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//结束时间</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 计算得到天、时、分、秒</span>
  <span class="token keyword">var</span> t <span class="token operator">=</span> endDate<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startDate<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    h <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">3600</span> <span class="token operator">/</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    h <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> d<span class="token punctuation">,</span> h<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h3 id="monthdays"><a href="#monthdays" class="header-anchor">#</a> monthDays</h3> <p><strong>获取指定日期月份的总天数。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 * @description 获取指定日期月份的总天数
 * @param {Date} time
 * @return {Number}
 */</span>
<span class="token keyword">function</span> <span class="token function">monthDays</span><span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 获取指定日期的年份，返回4位数</span>
  <span class="token keyword">var</span> year <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 获取指定日期的月份，范围为0-11，因此需要+1</span>
  <span class="token keyword">var</span> month <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

  <span class="token comment">// 通过形如new Date(year, monthIndex, day)来创建Date实例</span>
  <span class="token comment">// 然后获取指定年月的总天数，返回1-31</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="parsequerystring"><a href="#parsequerystring" class="header-anchor">#</a> <strong>parseQueryString</strong></h3> <p>**<code>url</code>参数转对象。**首先需要明确的是，<code>url</code>参数是<code>?</code>后面的形如<code>key1=value1&amp;key2=value2</code>的值。</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   url参数转对象
 * @param  {String} url  default: window.location.href
 * @return {Object}
 */</span>
<span class="token keyword">function</span> <span class="token function">parseQueryString</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果url为falsy，则使用window.location.href</span>
  url <span class="token operator">=</span> <span class="token operator">!</span>url <span class="token operator">?</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">:</span> url<span class="token punctuation">;</span>

  <span class="token comment">// 如果不存在?，意味着没有查询参数，直接返回空对象</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 如果url以?开头，则截取第一个字符串到最后；</span>
  <span class="token comment">// 否则找到最后的?，并截取?下一个字符串到最后</span>
  <span class="token keyword">var</span> search <span class="token operator">=</span>
    url<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;?&quot;</span> <span class="token operator">?</span> url<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;?&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 如果?后面为空，也意味着没有查询参数，返回空对象</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>search <span class="token operator">===</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 分割为key=value组成的数组</span>
  search <span class="token operator">=</span> search<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> search<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分割为[key, value]</span>
    <span class="token keyword">var</span> pair <span class="token operator">=</span> search<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 解码相应的值，并赋值给query对象</span>
    <span class="token comment">// value为falsy，则默认为空字符串</span>
    query<span class="token punctuation">[</span><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 最后返回query对象</span>
  <span class="token keyword">return</span> query<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>补充知识：</p> <ol><li><strong><code>substr()</code></strong>  方法返回一个字符串中从指定位置开始到指定字符数的字符。该参数接收两个参数。
<ol><li><code>start</code>参数。开始提取字符的位置。如果为负值，则被看作  <code>strLength + start，其中</code> <code>strLength</code>  为字符串的长度。</li> <li><code>length</code> 参数(可选)。提取的字符数。</li> <li><strong>避免使用</strong>该方法，使用<code>substring()</code>代替。上述示例完全可以进行代替。</li></ol></li> <li>**<code>substring()</code>**方法返回一个字符串在开始索引到结束索引之间的一个子集, 或从开始索引直到字符串的末尾的一个子集。该参数接收两个参数。
<ol><li><code>indexStart</code> 。需要截取的第一个字符的索引，该索引位置的字符作为返回的字符串的首字母。</li> <li><code>indexEnd</code> 。可选。一个 0 到字符串长度之间的整数，以该数字为索引的字符<strong>不包含</strong>在截取的字符串内。</li></ol></li></ol> <h3 id="stringfyquerystring"><a href="#stringfyquerystring" class="header-anchor">#</a> <strong>stringfyQueryString</strong></h3> <p><strong>对象序列化。</strong></p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">/**
 *
 * @description   对象序列化
 * @param  {Object} obj
 * @return {String}
 */</span>
<span class="token keyword">function</span> <span class="token function">stringfyQueryString</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 特殊值处理</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> pairs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果对象的值为数组，则处理成形如key[i]=value</span>
    <span class="token comment">// 同时进行编码处理</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pairs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
          <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot;[&quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token string">&quot;=&quot;</span> <span class="token operator">+</span>
            <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 对象的值不是数组，则处理成key=value</span>
    <span class="token comment">// 同时进行编码处理</span>
    pairs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 使用&amp;拼接并返回</span>
  <span class="token keyword">return</span> pairs<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>通过分析工具库，可以方便我们创建出自己的工具库，提高开发效率。以上就是所有工具库方法的解读，如有错误之处，请大家多多指教。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/FrontToEnd/vuepress-blog/edit/main/notes/工具库源码解析.md" target="_blank" rel="noopener noreferrer">帮助我改善这个页面</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">1/9/2022, 9:12:36 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/notes/如何学习前端.html" class="prev"><i aria-label="icon: left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i>
        如何学习前端
      </a></span> <span class="next"><a href="/notes/深入浅出TypeScript.html">
        深入浅出TypeScript
        <i aria-label="icon: right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></span></p></div> </main> <!----></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.3f4decce.js" defer></script><script src="/assets/js/2.bdf3ae06.js" defer></script><script src="/assets/js/90.86e48091.js" defer></script>
  </body>
</html>