(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{899:function(s,a,v){"use strict";v.r(a);var t=v(77),_=Object(t.a)({},(function(){var s=this,a=s.$createElement,v=s._self._c||a;return v("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[v("h1",{attrs:{id:"css硬件加速"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#css硬件加速"}},[s._v("#")]),s._v(" css硬件加速")]),s._v(" "),v("p",[s._v("近些年，我们总是听到硬件加速，以及它如何帮助我们提升网页的动画性能，让网页动画变得更好，在移动端更流畅。那么什么是硬件加速？如何触发硬件加速呢？")]),s._v(" "),v("h2",{attrs:{id:"定义"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[s._v("#")]),s._v(" 定义")]),s._v(" "),v("p",[v("code",[s._v("css")]),s._v("大部分样式还是通过"),v("code",[s._v("cpu")]),s._v("来计算的，但 "),v("code",[s._v("css")]),s._v("中也有一些 "),v("code",[s._v("3d")]),s._v("的样式和动画的样式，计算这些样式同样有很多重复且大量的计算任务，可以交给"),v("code",[s._v("gpu")]),s._v("来跑。")]),s._v(" "),v("p",[s._v("那么，使用"),v("code",[s._v("gpu")]),s._v("来渲染"),v("code",[s._v("css")]),s._v("的技术就是硬件加速。")]),s._v(" "),v("h2",{attrs:{id:"触发"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#触发"}},[s._v("#")]),s._v(" 触发")]),s._v(" "),v("p",[s._v("浏览器在处理下面的 "),v("code",[s._v("css")]),s._v(" 的时候，会使用 "),v("code",[s._v("gpu")]),s._v(" 渲染：")]),s._v(" "),v("ul",[v("li",[s._v("transform")]),s._v(" "),v("li",[s._v("opacity")]),s._v(" "),v("li",[s._v("filter")]),s._v(" "),v("li",[s._v("will-change")])]),s._v(" "),v("p",[s._v("注意的是 "),v("code",[s._v("gpu")]),s._v(" 硬件加速是需要新建图层的，而把该元素移动到新图层是个耗时操作，同时也会增加内存的使用。因此不能滥用硬件加速。")]),s._v(" "),v("h2",{attrs:{id:"属性详情"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#属性详情"}},[s._v("#")]),s._v(" 属性详情")]),s._v(" "),v("p",[s._v("CSS"),v("code",[s._v("transform")]),s._v("属性允许你旋转，缩放，倾斜或平移给定元素。这是通过修改CSS视觉格式化模型的坐标空间来实现的。")]),s._v(" "),v("p",[s._v("一般来说，可以通过指定以下属性来显示声明使用硬件加速：")]),s._v(" "),v("div",{staticClass:"language-css line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-css"}},[v("code",[v("span",{pre:!0,attrs:{class:"token property"}},[s._v("transform")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[s._v("rotate3d")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 0"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 0"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[s._v("1")]),v("br")])]),v("p",[v("code",[s._v("opacity")]),s._v("属性指定了一个元素的"),v("strong",[s._v("不透明度")]),s._v("。")]),s._v(" "),v("p",[s._v("当"),v("code",[s._v("opacity")]),s._v("属性的值应用于某个元素上时，是把这个元素（包括它的内容）当成一个"),v("strong",[s._v("整体")]),s._v("看待，即使这个值没有被子元素继承。因此，一个元素和它包含的子元素都会具有和元素背景相同的透明度，哪怕这个元素和它的子元素有不同的"),v("code",[s._v("opacity")]),s._v("属性值。")]),s._v(" "),v("p",[s._v("使用"),v("code",[s._v("opacity")]),s._v("属性，当属性值不为1时，会把元素放置在一个新的"),v("strong",[s._v("层叠上下文")]),s._v("中。")]),s._v(" "),v("p",[s._v("根据属性的定义，可以通过以下方式来显示声明使用硬件加速：")]),s._v(" "),v("div",{staticClass:"language-css line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-css"}},[v("code",[v("span",{pre:!0,attrs:{class:"token property"}},[s._v("opacity")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.99"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[s._v("1")]),v("br")])]),v("p",[v("code",[s._v("filter")]),s._v("CSS属性将模糊或颜色偏移等图形效果应用于元素。")]),s._v(" "),v("p",[s._v("最常用的应该是哀悼日时，通过设置"),v("code",[s._v("filter: grayscale(100%);")]),s._v("进行全站的灰化。")]),s._v(" "),v("p",[s._v("可以通过以下方式来显示声明使用硬件加速：")]),s._v(" "),v("div",{staticClass:"language-css line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-css"}},[v("code",[v("span",{pre:!0,attrs:{class:"token property"}},[s._v("filter")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[s._v("opacity")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("100%"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[s._v("1")]),v("br")])]),v("p",[v("code",[s._v("will-change")]),s._v("提供了一种告知浏览器该元素会有哪些变化的方法，这样浏览器可以在元素属性真正发生变化之前提前做好对应的优化准备工作。")]),s._v(" "),v("p",[s._v("使用该属性"),v("strong",[s._v("需要注意")]),s._v("：")]),s._v(" "),v("ul",[v("li",[s._v("不要将 "),v("code",[s._v("will-change")]),s._v(" 应用到太多元素上。")]),s._v(" "),v("li",[s._v("有节制地使用。")]),s._v(" "),v("li",[s._v("不要过早应用 "),v("code",[s._v("will-change")]),s._v(" 优化。")]),s._v(" "),v("li",[s._v("给它足够的工作时间。")])]),s._v(" "),v("p",[s._v("如果我们需要使用"),v("code",[s._v("opacity")]),s._v("来开启硬件加速，可以这么声明：")]),s._v(" "),v("div",{staticClass:"language-css line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-css"}},[v("code",[v("span",{pre:!0,attrs:{class:"token property"}},[s._v("will-change")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" opacity"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),v("span",{pre:!0,attrs:{class:"token property"}},[s._v("opacity")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.99"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[s._v("1")]),v("br"),v("span",{staticClass:"line-number"},[s._v("2")]),v("br")])]),v("h2",{attrs:{id:"验证"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[s._v("#")]),s._v(" 验证")]),s._v(" "),v("p",[s._v("如果我们指定了上述的属性，接下来如何进行验证是否生效呢？")]),s._v(" "),v("p",[s._v("步骤如下：")]),s._v(" "),v("ol",[v("li",[s._v("打开"),v("code",[s._v("Chrome")]),s._v("的开发者工具；")]),s._v(" "),v("li",[s._v("打开"),v("code",[s._v("Rendering")]),s._v("面板；")]),s._v(" "),v("li",[s._v("勾选"),v("code",[s._v("Layer borders")]),s._v("；")])]),s._v(" "),v("p",[s._v("然后会发现页面上出现蓝色和黄色的框。蓝色的是 "),v("code",[s._v("cpu")]),s._v(" 渲染的，而黄色的是 "),v("code",[s._v("gpu")]),s._v(" 渲染的。")]),s._v(" "),v("h2",{attrs:{id:"总结"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),v("p",[s._v("本文总结了触发CSS硬件加速的方式，以及属性的详情介绍。同时还介绍了验证硬件加速是否生效的方法。")]),s._v(" "),v("p",[s._v("最后需要我们注意的是，要有节制的使用硬件加速， 给它足够的工作时间。")]),s._v(" "),v("h2",{attrs:{id:"补充"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#补充"}},[s._v("#")]),s._v(" 补充")]),s._v(" "),v("p",[v("code",[s._v("CSS")]),s._v(" 动画（"),v("code",[s._v("Web")]),s._v(" 动画同理）优化的第一条准则就是让需要动画的元素生成了自己独立的 "),v("code",[s._v("GraphicsLayer")]),s._v("，强制开始 "),v("code",[s._v("GPU")]),s._v(" 加速。而我们需要知道是，"),v("code",[s._v("GPU")]),s._v(" 加速的本质是利用让元素生成了自己独立的 "),v("code",[s._v("GraphicsLayer")]),s._v("，降低了页面在渲染过程中重绘重排的开销。")]),s._v(" "),v("p",[s._v("生成自己的独立的 "),v("code",[s._v("GraphicsLayer")]),s._v(" 有以下方式：")]),s._v(" "),v("ul",[v("li",[s._v("3D 或透视变换(perspective、transform) CSS 属性")]),s._v(" "),v("li",[s._v("使用加速视频解码的")]),s._v(" "),v("li",[s._v("拥有 3D (WebGL) 上下文或加速的 2D 上下文的 元素")]),s._v(" "),v("li",[s._v("混合插件(如 Flash)")]),s._v(" "),v("li",[s._v("对自己的 opacity 做 CSS 动画或使用一个动画变换的元素")]),s._v(" "),v("li",[s._v("拥有加速 CSS 过滤器的元素")]),s._v(" "),v("li",[s._v("元素有一个包含复合层的后代节点(换句话说，就是一个元素拥有一个子元素，该子元素在自己的层里)")]),s._v(" "),v("li",[s._v("元素有一个 z-index 较低且包含一个复合层的兄弟元素(换句话说就是该元素在复合层上面渲染)")])])])}),[],!1,null,null,null);a.default=_.exports}}]);